<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Decommissioning nodes is a normal part of cluster operations for a variety of reasons: server maintenance, operating system upgrades, etc. Nomad offers a number of parameters for controlling how running jobs are migrated off of draining nodes.">

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-d0ced218.png">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-194x194-bb8de46a.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/assets/images/favicons/android-chrome-192x192-9f336178.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32-10aa6ba6.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16-330a0dd1.png" sizes="16x16">
    <link rel="manifest" href="/android-manifest.json">
    <link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab-479e3179.svg" color="#25BA81">
    <meta name="apple-mobile-web-app-title" content="HashiCorp Nomad">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="application-name" content="HashiCorp Nomad">
    <meta name="msapplication-config" content="/microsoft-tile.xml" />
    <meta name="msapplication-TileColor" content="#25BA81">
    <meta name="msapplication-TileImage" content="/assets/images/favicons/mstile-144x144-7f37eaf2.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@HashiCorp" />
    <meta name="twitter:creator" content="@HashiCorp" />
    <meta property="og:url" content="https://www.nomadproject.io/guides/node-draining.html" />
    <meta property="og:title" content="Decommissioning Nodes - Nomad by HashiCorp" />
    <meta property="og:site_name" content="Nomad by HashiCorp"/>
    <meta property="og:image" content="https://www.nomadproject.io/assets/images/og-image-e0e8d18d.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="1200"/>
    <meta property="og:description" content="Decommissioning nodes is a normal part of cluster operations for a variety of reasons: server maintenance, operating system upgrades, etc. Nomad offers a number of parameters for controlling how running jobs are migrated off of draining nodes." />

    <title>Decommissioning Nodes - Nomad by HashiCorp</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://use.typekit.net/wxf7mfi.css">
    <link href="/assets/stylesheets/application-b44b5029.css" rel="stylesheet" />

    <!-- Site scripts -->
    <!--[if lt IE 9]><script src="/assets/javascripts/ie-compat-c141a02d.js" defer="defer"></script><![endif]-->
    <script src="/assets/javascripts/application-4af6ff56.js" defer="defer"></script>

    <!-- Analytics scrpts -->
    <script defer>
      !function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],e.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(t,a)},e.SNIPPET_VERSION="4.0.0",e.load("qW11yxgipKMsKFKQUCpTVgQUYftYsJj0")}}();var om597a24292a958,om597a24292a958_poll=function(){var e=0;return function(t,a){clearInterval(e),e=setInterval(t,a)}}();!function(e,t,a){if(e.getElementById(a))om597a24292a958_poll(function(){if(window.om_loaded&&!om597a24292a958)return(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0})},25);else{var n=!1,o=e.createElement("script");o.id=a,o.src="//a.optnmstr.com/app/js/api.min.js",o.async=!0,o.onload=o.onreadystatechange=function(){if(!(n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState))try{n=om_loaded=!0,(om597a24292a958=new OptinMonsterApp).init({s:"35109.597a24292a958",staging:0,dev:0,beta:0}),o.onload=o.onreadystatechange=null}catch(e){}},(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)}}(document,0,"omapi-script");
    </script>

    
  </head>

  <body id="page-guides-decommissioning-nodes" class="layout-guides page-decommissioning-nodes">

    <svg class="hidden-print" aria-hidden="true" style="position: absolute; width: 0; height: 0;" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <symbol id="mega-nav-icon-angle" viewBox="0 0 13 7">
      <polygon points="6.5,6.5 0.7,1.6 1.3,0.8 6.5,5.2 11.7,0.8 12.3,1.6 "/>
    </symbol>
    <symbol id="mega-nav-icon-close" viewBox="0 0 13 15">
      <path vector-effect="non-scaling-stroke" d="M1.1 14L11.9 1M11.9 14L1.1 1"/>
    </symbol>
  </defs>
</svg>
<div class="hidden-print mega-nav-sandbox">
  <div class="mega-nav-banner">
    <div class="container">
      <div class="mega-nav-banner-item">
        <a class="mega-nav-banner-logo" href="https://www.hashicorp.com"><img src="/assets/images/mega-nav/logo-hashicorp-wordmark-bbed0e8a.svg" alt="HashiCorp Logo" /></a>
      </div>
      <div class="mega-nav-banner-item">
        <p class="mega-nav-tagline"><span class="visible-xs text-muted">Learn the</span><span class="hidden-xs text-muted">Learn how Nomad fits into the</span></p>
        <div id="#mega-nav" class="mega-nav">
          <button type="button" id="mega-nav-ctrl" class="mega-nav-ctrl">
            <div class="mega-nav-ctrl-items">
              <img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" />
              <strong>HashiCorp Suite</strong>
              <span class="mega-nav-icon-outline">
                <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg><span class="visuallyhidden">Open</span>
              </span>
            </div>
          </button>
          <div id="mega-nav-body-ct" class="mega-nav-body-ct" aria-labelledby="mega-nav-ctrl">
            <div class="mega-nav-body">
              <button type="button" id="mega-nav-close" class="mega-nav-close"><svg class="mega-nav-icon mega-nav-icon-close" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-close"></use></svg><span class="visuallyhidden">Close</span></button>
              <div class="mega-nav-body-header">
                <div class="mega-nav-body-header-item">
                  <h2 class="mega-nav-h1">Provision, Secure, Connect, and&nbsp;Run</h2>
                  <p class="mega-nav-h2">Any infrastructure for any&nbsp;application</p>
                </div>
                <div class="mega-nav-body-header-item">
                  <a href="https://www.hashicorp.com/" class="mega-nav-btn"><img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" /> Learn the HashiCorp Enterprise&nbsp;Suite <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg></a>
                </div>
              </div>
              <div class="mega-nav-body-grid">
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Provision</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vagrantup.com" class="mega-nav-grid-item mega-nav-grid-item-vagrant">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vagrant-a7ab5898.svg" alt="Vagrant Logo" />
                        </div>
                        <b>Vagrant</b>
                        <ul>
                          <li><span class="mega-nav-tag">Build</span></li>
                          <li><span class="mega-nav-tag">Test</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.packer.io" class="mega-nav-grid-item mega-nav-grid-item-packer">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-packer-cb3b9b94.svg" alt="Packer Logo" />
                        </div>
                        <b>Packer</b>
                        <ul>
                          <li><span class="mega-nav-tag">Package</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.terraform.io" class="mega-nav-grid-item mega-nav-grid-item-terraform">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-terraform-ff69eaae.svg" alt="Terraform Logo" />
                        </div>
                        <b>Terraform</b>
                        <ul>
                          <li><span class="mega-nav-tag">Provision</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Secure</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vaultproject.io" class="mega-nav-grid-item mega-nav-grid-item-vault">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vault-0f83e3d2.svg" alt="Vault Logo" />
                        </div>
                        <b>Vault</b>
                        <ul>
                          <li><span class="mega-nav-tag">Secure</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Connect</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.consul.io" class="mega-nav-grid-item mega-nav-grid-item-consul">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-consul-c77f6844.svg" alt="Consul Logo" />
                        </div>
                        <b>Consul</b>
                        <ul>
                          <li><span class="mega-nav-tag">Connect</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Run</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.nomadproject.io" class="mega-nav-grid-item mega-nav-grid-item-nomad">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-nomad-c4c148be.svg" alt="Nomad Logo" />
                        </div>
                        <b>Nomad</b>
                        <ul>
                          <li><span class="mega-nav-tag">Run</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="mega-nav-body-footer">
                <p>Seven elements of the modern Application Lifecycle</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <div id="header" class="navigation navbar-static-top hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <div class="navbar-header">
              <div class="navbar-brand">
                <a href="/">
                  <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 207 60" class="logo" height="50">
  <g fill="none">
    <path class="top" fill="#25BA81" d="M26.03.01L0 15.05l17.56 10.32 3.56-2.17 8.63 4.82v-10l8.27-4.97v10.02l14.48-8.02v-.04"></path>
    <path class="left" fill="#25BA81" d="M22.75 32.03v9.99l-7.88 5v-20l2.99-1.83L.15 15.05H0v29.96l26.25 15V34.03"></path>
    <path class="right" fill="#1F9967" d="M38.02 23.07v9.95l-6.93 4.01-4.84-3v25.98h.14l26.11-15V15.05l-.49-.01"></path>
    <path class="text" fill="#000" d="M78.49 21.83v24.24h-5.9v-32h8.06l12.14 24.32V14.1h5.9v32h-8.06m22.46.45c-8 0-10.18-4.42-10.18-9.22v-5.9c0-4.8 2.16-9.22 10.18-9.22s10.18 4.42 10.18 9.22v5.91c0 4.79-2.16 9.21-10.18 9.21zm0-19.35c-3.12 0-4.32 1.39-4.32 4v6.29c0 2.64 1.2 4 4.32 4s4.32-1.39 4.32-4v-6.25c0-2.64-1.2-4.04-4.32-4.04zm27.99 18.87V29.75c0-1.25-.53-1.87-1.87-1.87-2.147.252-4.22.932-6.1 2v16.19h-5.86V22.69h4.46l.58 2c2.916-1.46 6.104-2.293 9.36-2.45 1.852-.175 3.616.823 4.42 2.5 2.922-1.495 6.13-2.348 9.41-2.5 3.89 0 5.28 2.74 5.28 6.91v16.92h-5.86V29.75c0-1.25-.53-1.87-1.87-1.87-2.15.234-4.23.915-6.1 2v16.19h-5.85zm41.81 0h-4.8l-.43-1.58c-2.084 1.352-4.516 2.068-7 2.06-4.27 0-6.1-2.93-6.1-7 0-4.75 2.06-6.58 6.82-6.58H177v-2.41c0-2.59-.72-3.5-4.46-3.5-2.18.024-4.35.265-6.48.72l-.72-4.46c2.606-.72 5.296-1.09 8-1.1 7.34 0 9.5 2.59 9.5 8.45l.05 15.4zM177 37.24h-4.32c-1.92 0-2.45.53-2.45 2.3 0 1.77.53 2.35 2.35 2.35 1.55-.02 3.07-.434 4.42-1.2v-3.45zm9.48-6.77c0-5.18 2.3-8.26 7.73-8.26 2.097.02 4.187.244 6.24.67v-9.74l5.86-.82v33.75h-4.66l-.58-2c-2.133 1.595-4.726 2.454-7.39 2.45-4.7 0-7.2-2.79-7.2-8.11v-7.94zm14-2.64c-1.702-.38-3.437-.588-5.18-.62-2.11 0-2.93 1-2.93 3.12v8.26c0 1.92.72 3 2.88 3 1.937-.07 3.787-.816 5.23-2.11V27.83z"></path>
  </g>
</svg>

                </a>
              </div>
              <button class="navbar-toggle" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="buttons hidden-xs">
              <nav class="navigation-links" role="navigation">
                <ul class="main-links nav navbar-nav navbar-right">
                  <li><a href="/intro/index.html">Intro</a></li>
                  <li><a href="/guides/index.html">Guides</a></li>
                  <li><a href="/docs/index.html">Docs</a></li>
                  <li><a href="/api/index.html">API</a></li>
                  <li><a href="/resources.html">Resources</a></li>
                  <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
                  <li><a href="https://demo.nomadproject.io">UI Demo</a></li>
                  <li>
                    <a href="/downloads.html">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
                    </a>
                  </li>
                  <li>
                    <a href="https://github.com/hashicorp/nomad">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-overlay"></div>

<aside class="sidebar" role="navigation">
  <div class="sidebar-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 207 60" height="42">
  <g fill="none">
    <path class="top" fill="#25BA81" d="M26.03.01L0 15.05l17.56 10.32 3.56-2.17 8.63 4.82v-10l8.27-4.97v10.02l14.48-8.02v-.04"></path>
    <path class="left" fill="#25BA81" d="M22.75 32.03v9.99l-7.88 5v-20l2.99-1.83L.15 15.05H0v29.96l26.25 15V34.03"></path>
    <path class="right" fill="#1F9967" d="M38.02 23.07v9.95l-6.93 4.01-4.84-3v25.98h.14l26.11-15V15.05l-.49-.01"></path>
    <path class="text" fill="#000" d="M78.49 21.83v24.24h-5.9v-32h8.06l12.14 24.32V14.1h5.9v32h-8.06m22.46.45c-8 0-10.18-4.42-10.18-9.22v-5.9c0-4.8 2.16-9.22 10.18-9.22s10.18 4.42 10.18 9.22v5.91c0 4.79-2.16 9.21-10.18 9.21zm0-19.35c-3.12 0-4.32 1.39-4.32 4v6.29c0 2.64 1.2 4 4.32 4s4.32-1.39 4.32-4v-6.25c0-2.64-1.2-4.04-4.32-4.04zm27.99 18.87V29.75c0-1.25-.53-1.87-1.87-1.87-2.147.252-4.22.932-6.1 2v16.19h-5.86V22.69h4.46l.58 2c2.916-1.46 6.104-2.293 9.36-2.45 1.852-.175 3.616.823 4.42 2.5 2.922-1.495 6.13-2.348 9.41-2.5 3.89 0 5.28 2.74 5.28 6.91v16.92h-5.86V29.75c0-1.25-.53-1.87-1.87-1.87-2.15.234-4.23.915-6.1 2v16.19h-5.85zm41.81 0h-4.8l-.43-1.58c-2.084 1.352-4.516 2.068-7 2.06-4.27 0-6.1-2.93-6.1-7 0-4.75 2.06-6.58 6.82-6.58H177v-2.41c0-2.59-.72-3.5-4.46-3.5-2.18.024-4.35.265-6.48.72l-.72-4.46c2.606-.72 5.296-1.09 8-1.1 7.34 0 9.5 2.59 9.5 8.45l.05 15.4zM177 37.24h-4.32c-1.92 0-2.45.53-2.45 2.3 0 1.77.53 2.35 2.35 2.35 1.55-.02 3.07-.434 4.42-1.2v-3.45zm9.48-6.77c0-5.18 2.3-8.26 7.73-8.26 2.097.02 4.187.244 6.24.67v-9.74l5.86-.82v33.75h-4.66l-.58-2c-2.133 1.595-4.726 2.454-7.39 2.45-4.7 0-7.2-2.79-7.2-8.11v-7.94zm14-2.64c-1.702-.38-3.437-.588-5.18-.62-2.11 0-2.93 1-2.93 3.12v8.26c0 1.92.72 3 2.88 3 1.937-.07 3.787-.816 5.23-2.11V27.83z"></path>
  </g>
</svg>

  </div>

  <ul class="nav sidebar-nav">
    <li><a href="/intro/index.html">Intro</a></li>
    <li><a href="/guides/index.html">Guides</a></li>
    <li><a href="/docs/index.html">Docs</a></li>
    <li><a href="/api/index.html">API</a></li>
    <li><a href="/community.html">Community</a></li>
    <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
    <li><a href="/security.html">Security</a></li>
    <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
  </ul>

  <div class="divider"></div>

  <ul class="external nav sidebar-nav">
    <li>
      <a href="/downloads.html">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
      </a>
    </li>
    <li>
      <a href="https://github.com/hashicorp/nomad">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
      </a>
    </li>
  </ul>
</aside>


    <div class="container">
  <div class="row">
    <div id="docs-sidebar" class="col-sm-4 col-md-3 col-xs-12 hidden-print" role="complementary">
            <ul class="nav docs-sidenav">

      <li>
        <a href="/guides/acl.html">ACLs</a>
      </li>

      <li>
        <a href="/guides/spark/spark.html">Apache Spark Integration</a>
        <ul class="nav">
          <li>
            <a href="/guides/spark/pre.html">Getting Started</a>
          </li>
          <li>
            <a href="/guides/spark/submit.html">Submitting Applications</a>
          </li>
          <li>
            <a href="/guides/spark/customizing.html">Customizing Applications</a>
          </li>
          <li>
            <a href="/guides/spark/resource.html">Resource Allocation</a>
          </li>
          <li>
            <a href="/guides/spark/dynamic.html">Dynamic Executors</a>
          </li>
          <li>
            <a href="/guides/spark/hdfs.html">Using HDFS</a>
          </li>
          <li>
            <a href="/guides/spark/monitoring.html">Monitoring Output</a>
          </li>
          <li>
            <a href="/guides/spark/configuration.html">Configuration Properties</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/guides/cluster/bootstrapping.html">Bootstrapping Clusters</a>
        <ul class="nav">
          <li>
            <a href="/guides/cluster/automatic.html">Automatic</a>
          </li>
          <li>
            <a href="/guides/cluster/autopilot.html">Autopilot</a>
          </li>
          <li>
            <a href="/guides/cluster/manual.html">Manual</a>
          </li>
          <li>
            <a href="/guides/cluster/federation.html">Federation</a>
          </li>
          <li>
            <a href="/guides/cluster/requirements.html">Requirements</a>
          </li>
        </ul>
      </li>

      <li class="active">
        <a href="/guides/node-draining.html">Decommissioning Nodes</a>
      </li>

      <li>
        <a href="/guides/namespaces.html">Namespaces</a>
      </li>

      <li>
        <a href="/guides/operating-a-job/index.html">Operating a Job</a>
        <ul class="nav">
          <li>
            <a href="/guides/operating-a-job/configuring-tasks.html">Configuring Tasks</a>
          </li>
          <li>
            <a href="/guides/operating-a-job/submitting-jobs.html">Submitting Jobs</a>
          </li>
          <li>
            <a href="/guides/operating-a-job/inspecting-state.html">Inspecting State</a>
          </li>
          <li>
            <a href="/guides/operating-a-job/accessing-logs.html">Accessing Logs</a>
          </li>
          <li>
            <a href="/guides/operating-a-job/resource-utilization.html">Resource Utilization</a>
          </li>
          <li>
            <a href="/guides/operating-a-job/update-strategies/index.html">Update Strategies</a>
            <ul class="nav">
              <li>
                <a href="/guides/operating-a-job/update-strategies/rolling-upgrades.html">Rolling Upgrades</a>
              </li>
              <li>
                <a href="/guides/operating-a-job/update-strategies/blue-green-and-canary-deployments.html">Blue/Green &amp; Canary</a>
              </li>
              <li>
                <a href="/guides/operating-a-job/update-strategies/handling-signals.html">Handling Signals</a>
              </li>
            </ul>
          </li>
           <li>
                      <a href="/guides/operating-a-job/failure-handling-strategies/index.html">Failure Recovery Strategies</a>
                      <ul class="nav">
                        <li>
                          <a href="/guides/operating-a-job/failure-handling-strategies/restart.html">Local Restarts</a>
                        </li>
                        <li>
                          <a href="/guides/operating-a-job/failure-handling-strategies/check-restart.html">Check Restarts</a>
                        </li>
                        <li>
                          <a href="/guides/operating-a-job/failure-handling-strategies/reschedule.html">Rescheduling</a>
                        </li>
                      </ul>
                    </li>
        </ul>
      </li>

      <li>
        <a href="/guides/outage.html">Outage Recovery</a>
      </li>

      <li>
        <a href="/guides/quotas.html">Resource Quotas</a>
      </li>

      <li>
        <a href="/guides/securing-nomad.html">Securing Nomad</a>
      </li>

      <li>
        <a href="/guides/sentinel-policy.html">Sentinel Policies</a>
        <ul class="nav">
          <li>
            <a href="/guides/sentinel/job.html">Job Object</a>
          </li>
        </ul>
      </li>

      <li>
        <a href="/guides/ui.html">Web UI</a>
      </li>
    </ul>

    </div>

    <div id="inner" class="col-sm-8 col-md-9 col-xs-12" role="main">
      
  <h1 id="decommissioning-nomad-client-nodes">
  <a name="decommissioning-nomad-client-nodes" class="anchor" href="#decommissioning-nomad-client-nodes">&raquo;</a>
  Decommissioning Nomad Client Nodes
</h1>
<p>Decommissioning nodes is a normal part of cluster operations for a variety of
reasons: server maintenance, operating system upgrades, etc. Nomad offers a
number of parameters for controlling how running jobs are migrated off of
draining nodes.</p>
<h2 id="configuring-how-jobs-are-migrated">
  <a name="configuring-how-jobs-are-migrated" class="anchor" href="#configuring-how-jobs-are-migrated">&raquo;</a>
  Configuring How Jobs are Migrated
</h2>
<p>In Nomad 0.8 a <a href="/docs/job-specification/migrate.html"><code>migrate</code></a> stanza was added to jobs to allow control
over how allocations for a job are migrated off of a draining node. Below is an
example job that runs a web service and has a Consul health check:</p>
<div class="highlight"><pre class="highlight hcl"><code><span class="n">job</span> <span class="s2">"webapp"</span> <span class="p">{</span>
  <span class="n">datacenters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"dc1"</span><span class="p">]</span>

  <span class="n">migrate</span> <span class="p">{</span>
    <span class="n">max_parallel</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">health_check</span> <span class="o">=</span> <span class="s2">"checks"</span>
    <span class="n">min_healthy_time</span> <span class="o">=</span> <span class="s2">"15s"</span>
    <span class="n">healthy_deadline</span> <span class="o">=</span> <span class="s2">"5m"</span>
  <span class="p">}</span>

  <span class="n">group</span> <span class="s2">"webapp"</span> <span class="p">{</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">9</span>

    <span class="n">task</span> <span class="s2">"webapp"</span> <span class="p">{</span>
      <span class="n">driver</span> <span class="o">=</span> <span class="s2">"docker"</span>
      <span class="n">config</span> <span class="p">{</span>
        <span class="n">image</span> <span class="o">=</span> <span class="s2">"hashicorp/http-echo:0.2.3"</span>
        <span class="n">args</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">"-text"</span><span class="p">,</span> <span class="s2">"ok"</span><span class="p">]</span>
        <span class="n">port_map</span> <span class="p">{</span>
          <span class="n">http</span> <span class="o">=</span> <span class="mi">5678</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="n">resources</span> <span class="p">{</span>
        <span class="n">network</span> <span class="p">{</span>
          <span class="n">mbits</span> <span class="o">=</span> <span class="mi">10</span>
          <span class="n">port</span> <span class="s2">"http"</span> <span class="p">{}</span>
        <span class="p">}</span>
      <span class="p">}</span>

      <span class="n">service</span> <span class="p">{</span>
        <span class="nb">name</span> <span class="o">=</span> <span class="s2">"webapp"</span>
        <span class="n">port</span> <span class="o">=</span> <span class="s2">"http"</span>
        <span class="n">check</span> <span class="p">{</span>
          <span class="nb">name</span> <span class="o">=</span> <span class="s2">"http-ok"</span>
          <span class="n">type</span> <span class="o">=</span> <span class="s2">"http"</span>
          <span class="n">path</span> <span class="o">=</span> <span class="s2">"/"</span>
          <span class="n">interval</span> <span class="o">=</span> <span class="s2">"10s"</span>
          <span class="n">timeout</span>  <span class="o">=</span> <span class="s2">"2s"</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>The above <code>migrate</code> stanza ensures only 2 allocations are stopped at a time to
migrate during node drains. Even if multiple nodes running allocations for this
job were draining at the same time, only 2 allocations would be migrated at a
time.</p>
<p>When the job is run it may be placed on multiple nodes. In the following
example the 9 <code>webapp</code> allocations are spread across 2 nodes:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad run webapp.nomad
==&gt; Monitoring evaluation "5129bc74"
    Evaluation triggered by job "webapp"
    Allocation "5b4d6db5" created: node "46f1c6c4", group "webapp"
    Allocation "670a715f" created: node "f7476465", group "webapp"
    Allocation "78b6b393" created: node "46f1c6c4", group "webapp"
    Allocation "85743ff5" created: node "f7476465", group "webapp"
    Allocation "edf71a5d" created: node "f7476465", group "webapp"
    Allocation "56f770c0" created: node "46f1c6c4", group "webapp"
    Allocation "9a51a484" created: node "46f1c6c4", group "webapp"
    Allocation "f6f6e64c" created: node "f7476465", group "webapp"
    Allocation "fefe81d0" created: node "f7476465", group "webapp"
    Evaluation status changed: "pending" -&gt; "complete"
==&gt; Evaluation "5129bc74" finished with status "complete"
</code></pre></div><p>If one those nodes needed to be decommissioned, perhaps because of a hardware
issue, then an operator would issue node drain to migrate the allocations off:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node drain -enable -yes 46f1
2018-04-11T23:41:56Z: Ctrl-C to stop monitoring: will not cancel the node drain
2018-04-11T23:41:56Z: Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" drain strategy set
2018-04-11T23:41:57Z: Alloc "5b4d6db5-3fcb-eb7d-0415-23eefcd78b6a" marked for migration
2018-04-11T23:41:57Z: Alloc "56f770c0-f8aa-4565-086d-01faa977f82d" marked for migration
2018-04-11T23:41:57Z: Alloc "56f770c0-f8aa-4565-086d-01faa977f82d" draining
2018-04-11T23:41:57Z: Alloc "5b4d6db5-3fcb-eb7d-0415-23eefcd78b6a" draining
2018-04-11T23:42:03Z: Alloc "56f770c0-f8aa-4565-086d-01faa977f82d" status running -&gt; complete
2018-04-11T23:42:03Z: Alloc "5b4d6db5-3fcb-eb7d-0415-23eefcd78b6a" status running -&gt; complete
2018-04-11T23:42:22Z: Alloc "78b6b393-d29c-d8f8-e8e8-28931c0013ee" marked for migration
2018-04-11T23:42:22Z: Alloc "78b6b393-d29c-d8f8-e8e8-28931c0013ee" draining
2018-04-11T23:42:27Z: Alloc "78b6b393-d29c-d8f8-e8e8-28931c0013ee" status running -&gt; complete
2018-04-11T23:42:29Z: Alloc "9a51a484-8c43-aa4e-d60a-46cfd1450780" marked for migration
2018-04-11T23:42:29Z: Alloc "9a51a484-8c43-aa4e-d60a-46cfd1450780" draining
2018-04-11T23:42:29Z: Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" has marked all allocations for migration
2018-04-11T23:42:34Z: Alloc "9a51a484-8c43-aa4e-d60a-46cfd1450780" status running -&gt; complete
2018-04-11T23:42:34Z: All allocations on node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" have stopped.
</code></pre></div><p>There are a couple important events to notice in the output. First, only 2
allocations are migrated initially:</p>
<div class="highlight"><pre class="highlight plaintext"><code>2018-04-11T23:41:57Z: Alloc "5b4d6db5-3fcb-eb7d-0415-23eefcd78b6a" marked for migration
2018-04-11T23:41:57Z: Alloc "56f770c0-f8aa-4565-086d-01faa977f82d" marked for migration
</code></pre></div><p>This is because <code>max_parallel = 2</code> in the job specification. The next
allocation on the draining node waits to be migrated:</p>
<div class="highlight"><pre class="highlight plaintext"><code>2018-04-11T23:42:22Z: Alloc "78b6b393-d29c-d8f8-e8e8-28931c0013ee" marked for migration
</code></pre></div><p>Note that this occurs 25 seconds after the initial migrations. The 25 second
delay is because a replacement allocation took 10 seconds to become healthy and
then the <code>min_healthy_time = &quot;15s&quot;</code> meant node draining waited an additional 15
seconds. If the replacement allocation had failed within that time the node
drain would not have continued until a replacement could be successfully made.</p>
<h3 id="scheduling-eligibility">
  <a name="scheduling-eligibility" class="anchor" href="#scheduling-eligibility">&raquo;</a>
  Scheduling Eligibility
</h3>
<p>Now that the example drain has finished we can inspect the state of the drained
node:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node status
ID        DC   Name     Class   Drain  Eligibility  Status
f7476465  dc1  nomad-1  &lt;none&gt;  false  eligible     ready
96b52ad8  dc1  nomad-2  &lt;none&gt;  false  eligible     ready
46f1c6c4  dc1  nomad-3  &lt;none&gt;  false  ineligible   ready
</code></pre></div><p>While node <code>46f1c6c4</code> has <code>Drain = false</code>, notice that its <code>Eligibility =
ineligible</code>. Node scheduling eligibility is a new field in Nomad 0.8. When a
node is ineligible for scheduling the scheduler will not consider it for new
placements.</p>
<p>While draining, a node will always be ineligible for scheduling. Once draining
completes it will remain ineligible to prevent refilling a newly drained node.</p>
<p>However, by default canceling a drain with the <code>-disable</code> option will reset a
node to be eligible for scheduling. To cancel a drain and preserving the node&#39;s
ineligible status use the <code>-keep-ineligible</code> option.</p>
<p>Scheduling eligibility can be toggled independently of node drains by using the
<a href="/docs/commands/node/eligibility.html"><code>nomad node eligibility</code></a> command:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node eligibility -disable 46f1
Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" scheduling eligibility set: ineligible for scheduling
</code></pre></div><h3 id="node-drain-deadline">
  <a name="node-drain-deadline" class="anchor" href="#node-drain-deadline">&raquo;</a>
  Node Drain Deadline
</h3>
<p>Sometimes a drain is unable to proceed and complete normally. This could be
caused by not enough capacity existing in the cluster to replace the drained
allocations or by replacement allocations failing to start successfully in a
timely fashion.</p>
<p>Operators may specify a deadline when enabling a node drain to prevent drains
from not finishing. Once the deadline is reached, all remaining allocations on
the node are stopped regardless of <code>migrate</code> stanza parameters.</p>
<p>The default deadline is 1 hour and may be changed with the
<a href="/docs/commands/node/drain.html#deadline"><code>-deadline</code></a> command line option. The <a href="/docs/commands/node/drain.html#force"><code>-force</code></a> option is an
instant deadline: all allocations are immediately stopped. The
<a href="/docs/commands/node/drain.html#no-deadline"><code>-no-deadline</code></a> option disables the deadline so a drain may
continue indefinitely.</p>
<p>Like all other drain parameters, a drain&#39;s deadline can be updated by making
subsequent <code>nomad node drain ...</code> calls with updated values.</p>
<h2 id="node-drains-and-non-service-jobs">
  <a name="node-drains-and-non-service-jobs" class="anchor" href="#node-drains-and-non-service-jobs">&raquo;</a>
  Node Drains and Non-Service Jobs
</h2>
<p>So far we have only seen how draining works with service jobs. Both batch and
system jobs are have different behaviors during node drains.</p>
<h3 id="draining-batch-jobs">
  <a name="draining-batch-jobs" class="anchor" href="#draining-batch-jobs">&raquo;</a>
  Draining Batch Jobs
</h3>
<p>Node drains only migrate batch jobs once the drain&#39;s deadline has been reached.
For node drains without a deadline the drain will not complete until all batch
jobs on the node have completed (or failed).</p>
<p>The goal of this behavior is to avoid losing progress a batch job has made by
forcing it to exit early.</p>
<h3 id="keeping-system-jobs-running">
  <a name="keeping-system-jobs-running" class="anchor" href="#keeping-system-jobs-running">&raquo;</a>
  Keeping System Jobs Running
</h3>
<p>Node drains only stop system jobs once all other allocations have exited. This
way if a node is running a log shipping daemon or metrics collector as a system
job, it will continue to run as long as there are other allocations running.</p>
<p>The <a href="/docs/commands/node/drain.html#ignore-system"><code>-ignore-system</code></a> option leaves system jobs running even
after all other allocations have exited. This is useful when system jobs are
used to monitor Nomad or the node itself.</p>
<h2 id="draining-multiple-nodes">
  <a name="draining-multiple-nodes" class="anchor" href="#draining-multiple-nodes">&raquo;</a>
  Draining Multiple Nodes
</h2>
<p>A common operation is to decommission an entire class of nodes at once. Prior
to Nomad 0.7 this was a problematic operation as the first node to begin
draining may migrate all of their allocations to the next node about to be
drained. In pathological cases this could repeat on each node to be drained and
cause allocations to be rescheduled repeatedly.</p>
<p>As of Nomad 0.8 an operator can avoid this churn by marking nodes ineligible
for scheduling before draining them using the <a href="/docs/commands/node/eligibility.html"><code>nomad node
eligibility</code></a> command:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node eligibility -disable 46f1
Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" scheduling eligibility set: ineligible for scheduling

$ nomad node eligibility -disable 96b5
Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" scheduling eligibility set: ineligible for scheduling

$ nomad node status
ID        DC   Name     Class   Drain  Eligibility  Status
f7476465  dc1  nomad-1  &lt;none&gt;  false  eligible     ready
46f1c6c4  dc1  nomad-2  &lt;none&gt;  false  ineligible   ready
96b52ad8  dc1  nomad-3  &lt;none&gt;  false  ineligible   ready
</code></pre></div><p>Now that both <code>nomad-2</code> and <code>nomad-3</code> are ineligible for scheduling, they can
be drained without risking placing allocations on an <em>about-to-be-drained</em>
node.</p>
<p>Toggling scheduling eligibility can be done totally independently of draining.
For example when an operator wants to inspect the allocations currently running
on a node without risking new allocations being scheduled and changing the
node&#39;s state:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node eligibility -self -disable
Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" scheduling eligibility set: ineligible for scheduling

$ # ...inspect node state...

$ nomad node eligibility -self -enable
Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" scheduling eligibility set: eligible for scheduling
</code></pre></div><h3 id="example-migrating-datacenters">
  <a name="example-migrating-datacenters" class="anchor" href="#example-migrating-datacenters">&raquo;</a>
  Example: Migrating Datacenters
</h3>
<p>A more complete example of draining multiple nodes would be when migrating from
an old datacenter (<code>dc1</code>) to a new datacenter (<code>dc2</code>):</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node status -allocs
ID        DC   Name     Class   Drain  Eligibility  Status  Running Allocs
f7476465  dc1  nomad-1  &lt;none&gt;  false  eligible     ready   4
46f1c6c4  dc1  nomad-2  &lt;none&gt;  false  eligible     ready   1
96b52ad8  dc1  nomad-3  &lt;none&gt;  false  eligible     ready   4
168bdd03  dc2  nomad-4  &lt;none&gt;  false  eligible     ready   0
9ccb3306  dc2  nomad-5  &lt;none&gt;  false  eligible     ready   0
7a7f9a37  dc2  nomad-6  &lt;none&gt;  false  eligible     ready   0
</code></pre></div><p>Before migrating ensure that all jobs in <code>dc1</code> have <code>datacenters = [&quot;dc1&quot;,
&quot;dc2&quot;]</code>.  Then before draining, mark all nodes in <code>dc1</code> as ineligible for
scheduling. Shell scripting can help automate manipulating multiple nodes at
once:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node status | awk '{ print $2 " " $1 }' | grep ^dc1 | awk '{ system("nomad node eligibility -disable "$2) }'
Node "f7476465-4d6e-c0de-26d0-e383c49be941" scheduling eligibility set: ineligible for scheduling
Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" scheduling eligibility set: ineligible for scheduling
Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" scheduling eligibility set: ineligible for scheduling

$ nomad node status
ID        DC   Name     Class   Drain  Eligibility  Status
f7476465  dc1  nomad-1  &lt;none&gt;  false  ineligible   ready
46f1c6c4  dc1  nomad-2  &lt;none&gt;  false  ineligible   ready
96b52ad8  dc1  nomad-3  &lt;none&gt;  false  ineligible   ready
168bdd03  dc2  nomad-4  &lt;none&gt;  false  eligible     ready
9ccb3306  dc2  nomad-5  &lt;none&gt;  false  eligible     ready
7a7f9a37  dc2  nomad-6  &lt;none&gt;  false  eligible     ready
</code></pre></div><p>Then drain each node in <code>dc1</code>. For this example we will only monitor the final
node that is draining. Watching <code>nomad node status -allocs</code> is also a good way
to monitor the status of drains.</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ nomad node drain -enable -yes -detach f7476465
Node "f7476465-4d6e-c0de-26d0-e383c49be941" drain strategy set

$ nomad node drain -enable -yes -detach 46f1c6c4
Node "46f1c6c4-a0e5-21f6-fd5c-d76c3d84e806" drain strategy set

$ nomad node drain -enable -yes 9ccb3306
2018-04-12T22:08:00Z: Ctrl-C to stop monitoring: will not cancel the node drain
2018-04-12T22:08:00Z: Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" drain strategy set
2018-04-12T22:08:15Z: Alloc "392ee2ec-d517-c170-e7b1-d93b2d44642c" marked for migration
2018-04-12T22:08:16Z: Alloc "392ee2ec-d517-c170-e7b1-d93b2d44642c" draining
2018-04-12T22:08:17Z: Alloc "6a833b3b-c062-1f5e-8dc2-8b6af18a5b94" marked for migration
2018-04-12T22:08:17Z: Alloc "6a833b3b-c062-1f5e-8dc2-8b6af18a5b94" draining
2018-04-12T22:08:21Z: Alloc "392ee2ec-d517-c170-e7b1-d93b2d44642c" status running -&gt; complete
2018-04-12T22:08:22Z: Alloc "6a833b3b-c062-1f5e-8dc2-8b6af18a5b94" status running -&gt; complete
2018-04-12T22:09:08Z: Alloc "d572d7a3-024b-fcb7-128b-1932a49c8d79" marked for migration
2018-04-12T22:09:09Z: Alloc "d572d7a3-024b-fcb7-128b-1932a49c8d79" draining
2018-04-12T22:09:14Z: Alloc "d572d7a3-024b-fcb7-128b-1932a49c8d79" status running -&gt; complete
2018-04-12T22:09:33Z: Alloc "f3f24277-4435-56a3-7ee1-1b1eff5e3aa1" marked for migration
2018-04-12T22:09:33Z: Alloc "f3f24277-4435-56a3-7ee1-1b1eff5e3aa1" draining
2018-04-12T22:09:33Z: Node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" has marked all allocations for migration
2018-04-12T22:09:39Z: Alloc "f3f24277-4435-56a3-7ee1-1b1eff5e3aa1" status running -&gt; complete
2018-04-12T22:09:39Z: All allocations on node "96b52ad8-e9ad-1084-c14f-0e11f10772e4" have stopped.
</code></pre></div><p>Note that there was a 15 second delay between node <code>96b52ad8</code> starting to drain
and having its first allocation migrated. The delay was due to 2 other
allocations for the same job already being migrated from the other nodes. Once
at least 8 out of the 9 allocations are running for the job, another allocation
could begin draining.</p>
<p>The final node drain command did not exit until 6 seconds after the <code>drain
complete</code> message because the command line tool blocks until all allocations on
the node have stopped. This allows operators to script shutting down a node
once a drain command exits and know all services have already exited.</p>


    </div>
  </div>
</div>


    <div id="footer" class="navigation hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <ul class="footer-links nav navbar-nav">
              <li><a href="/intro/index.html">Intro</a></li>
              <li><a href="/guides/index.html">Guides</a></li>
              <li><a href="/docs/index.html">Docs</a></li>
              <li><a href="/api/index.html">API</a></li>
              <li><a href="/resources.html">Resources</a></li>
              <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
              <li><a href="https://demo.nomadproject.io">UI Demo</a></li>
              <li><a href="https://www.hashicorp.com/privacy">Privacy</a></li>
              <li><a href="/security.html">Security</a></li>
              <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
            </ul>
            <ul class="footer-links nav navbar-nav navbar-right">
              <li><a href="https://github.com/hashicorp/nomad/blob/master/website/source/guides/node-draining.html.md">Edit this page</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Product",
        "name": "Nomad",
        "alternateName": "Nomad by HashiCorp",
        "manufacturer": "HashiCorp",
        "url": "https://www.nomadproject.io",
        "logo": "https://www.nomadproject.io/assets/images/logo-hashicorp-039941e4.svg",
        "sameAs": [
          "https://github.com/hashicorp/nomad"
        ]
      }
    </script>
  </body>
</html>
