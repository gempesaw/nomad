<!DOCTYPE html>
<html lang="en">
  <head><base href="/nomad">
    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Jobs can also be specified via the HTTP API using a JSON format. This guide discusses the job specification in JSON format.">

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-d0ced218.png">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-194x194-bb8de46a.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/assets/images/favicons/android-chrome-192x192-9f336178.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32-10aa6ba6.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16-330a0dd1.png" sizes="16x16">
    <link rel="manifest" href="/android-manifest.json">
    <link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab-479e3179.svg" color="#25BA81">
    <meta name="apple-mobile-web-app-title" content="HashiCorp Nomad">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="application-name" content="HashiCorp Nomad">
    <meta name="msapplication-config" content="/microsoft-tile.xml" />
    <meta name="msapplication-TileColor" content="#25BA81">
    <meta name="msapplication-TileImage" content="/assets/images/favicons/mstile-144x144-7f37eaf2.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@HashiCorp" />
    <meta name="twitter:creator" content="@HashiCorp" />
    <meta property="og:url" content="https://www.nomadproject.io/api/json-jobs.html" />
    <meta property="og:title" content="JSON Job Specification - HTTP API - Nomad by HashiCorp" />
    <meta property="og:site_name" content="Nomad by HashiCorp"/>
    <meta property="og:image" content="https://www.nomadproject.io/assets/images/og-image-e0e8d18d.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="1200"/>
    <meta property="og:description" content="Jobs can also be specified via the HTTP API using a JSON format. This guide discusses the job specification in JSON format." />

    <title>JSON Job Specification - HTTP API - Nomad by HashiCorp</title>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://use.typekit.net/wxf7mfi.css">
    <link href="/assets/stylesheets/application-b44b5029.css" rel="stylesheet" />

    <!-- Site scripts -->
    <!--[if lt IE 9]><script src="/assets/javascripts/ie-compat-c141a02d.js" defer="defer"></script><![endif]-->
    <script src="/assets/javascripts/application-4af6ff56.js" defer="defer"></script>


  </head>

  <body id="page-api-json-jobs" class="layout-api page-json-job-specification-http-api">

    <svg class="hidden-print" aria-hidden="true" style="position: absolute; width: 0; height: 0;" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <symbol id="mega-nav-icon-angle" viewBox="0 0 13 7">
      <polygon points="6.5,6.5 0.7,1.6 1.3,0.8 6.5,5.2 11.7,0.8 12.3,1.6 "/>
    </symbol>
    <symbol id="mega-nav-icon-close" viewBox="0 0 13 15">
      <path vector-effect="non-scaling-stroke" d="M1.1 14L11.9 1M11.9 14L1.1 1"/>
    </symbol>
  </defs>
</svg>
<div class="hidden-print mega-nav-sandbox">
  <div class="mega-nav-banner">
    <div class="container">
      <div class="mega-nav-banner-item">
        <a class="mega-nav-banner-logo" href="https://www.hashicorp.com"><img src="/assets/images/mega-nav/logo-hashicorp-wordmark-bbed0e8a.svg" alt="HashiCorp Logo" /></a>
      </div>
      <div class="mega-nav-banner-item">
        <p class="mega-nav-tagline"><span class="visible-xs text-muted">Learn the</span><span class="hidden-xs text-muted">Learn how Nomad fits into the</span></p>
        <div id="#mega-nav" class="mega-nav">
          <button type="button" id="mega-nav-ctrl" class="mega-nav-ctrl">
            <div class="mega-nav-ctrl-items">
              <img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" />
              <strong>HashiCorp Suite</strong>
              <span class="mega-nav-icon-outline">
                <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg><span class="visuallyhidden">Open</span>
              </span>
            </div>
          </button>
          <div id="mega-nav-body-ct" class="mega-nav-body-ct" aria-labelledby="mega-nav-ctrl">
            <div class="mega-nav-body">
              <button type="button" id="mega-nav-close" class="mega-nav-close"><svg class="mega-nav-icon mega-nav-icon-close" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-close"></use></svg><span class="visuallyhidden">Close</span></button>
              <div class="mega-nav-body-header">
                <div class="mega-nav-body-header-item">
                  <h2 class="mega-nav-h1">Provision, Secure, Connect, and&nbsp;Run</h2>
                  <p class="mega-nav-h2">Any infrastructure for any&nbsp;application</p>
                </div>
                <div class="mega-nav-body-header-item">
                  <a href="https://www.hashicorp.com/" class="mega-nav-btn"><img src="/assets/images/mega-nav/logo-hashicorp-a66fda95.svg" alt="HashiCorp Logo" /> Learn the HashiCorp Enterprise&nbsp;Suite <svg class="mega-nav-icon mega-nav-icon-angle-right" aria-hidden="true"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#mega-nav-icon-angle"></use></svg></a>
                </div>
              </div>
              <div class="mega-nav-body-grid">
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Provision</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vagrantup.com" class="mega-nav-grid-item mega-nav-grid-item-vagrant">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vagrant-a7ab5898.svg" alt="Vagrant Logo" />
                        </div>
                        <b>Vagrant</b>
                        <ul>
                          <li><span class="mega-nav-tag">Build</span></li>
                          <li><span class="mega-nav-tag">Test</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.packer.io" class="mega-nav-grid-item mega-nav-grid-item-packer">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-packer-cb3b9b94.svg" alt="Packer Logo" />
                        </div>
                        <b>Packer</b>
                        <ul>
                          <li><span class="mega-nav-tag">Package</span></li>
                        </ul>
                      </a>
                    </li>
                    <li>
                      <a href="https://www.terraform.io" class="mega-nav-grid-item mega-nav-grid-item-terraform">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-terraform-ff69eaae.svg" alt="Terraform Logo" />
                        </div>
                        <b>Terraform</b>
                        <ul>
                          <li><span class="mega-nav-tag">Provision</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Secure</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.vaultproject.io" class="mega-nav-grid-item mega-nav-grid-item-vault">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-vault-0f83e3d2.svg" alt="Vault Logo" />
                        </div>
                        <b>Vault</b>
                        <ul>
                          <li><span class="mega-nav-tag">Secure</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Connect</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.consul.io" class="mega-nav-grid-item mega-nav-grid-item-consul">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-consul-c77f6844.svg" alt="Consul Logo" />
                        </div>
                        <b>Consul</b>
                        <ul>
                          <li><span class="mega-nav-tag">Connect</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
                <div class="mega-nav-body-grid-item">
                  <h3 class="mega-nav-h3">Run</h3>
                  <ul class="mega-nav-grid">
                    <li>
                      <a href="https://www.nomadproject.io" class="mega-nav-grid-item mega-nav-grid-item-nomad">
                        <div class="mega-nav-grid-item-img">
                          <img src="/assets/images/mega-nav/logo-nomad-c4c148be.svg" alt="Nomad Logo" />
                        </div>
                        <b>Nomad</b>
                        <ul>
                          <li><span class="mega-nav-tag">Run</span></li>
                        </ul>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="mega-nav-body-footer">
                <p>Seven elements of the modern Application Lifecycle</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <div id="header" class="navigation navbar-static-top hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <div class="navbar-header">
              <div class="navbar-brand">
                <a href="/">
                  <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 207 60" class="logo" height="50">
  <g fill="none">
    <path class="top" fill="#25BA81" d="M26.03.01L0 15.05l17.56 10.32 3.56-2.17 8.63 4.82v-10l8.27-4.97v10.02l14.48-8.02v-.04"></path>
    <path class="left" fill="#25BA81" d="M22.75 32.03v9.99l-7.88 5v-20l2.99-1.83L.15 15.05H0v29.96l26.25 15V34.03"></path>
    <path class="right" fill="#1F9967" d="M38.02 23.07v9.95l-6.93 4.01-4.84-3v25.98h.14l26.11-15V15.05l-.49-.01"></path>
    <path class="text" fill="#000" d="M78.49 21.83v24.24h-5.9v-32h8.06l12.14 24.32V14.1h5.9v32h-8.06m22.46.45c-8 0-10.18-4.42-10.18-9.22v-5.9c0-4.8 2.16-9.22 10.18-9.22s10.18 4.42 10.18 9.22v5.91c0 4.79-2.16 9.21-10.18 9.21zm0-19.35c-3.12 0-4.32 1.39-4.32 4v6.29c0 2.64 1.2 4 4.32 4s4.32-1.39 4.32-4v-6.25c0-2.64-1.2-4.04-4.32-4.04zm27.99 18.87V29.75c0-1.25-.53-1.87-1.87-1.87-2.147.252-4.22.932-6.1 2v16.19h-5.86V22.69h4.46l.58 2c2.916-1.46 6.104-2.293 9.36-2.45 1.852-.175 3.616.823 4.42 2.5 2.922-1.495 6.13-2.348 9.41-2.5 3.89 0 5.28 2.74 5.28 6.91v16.92h-5.86V29.75c0-1.25-.53-1.87-1.87-1.87-2.15.234-4.23.915-6.1 2v16.19h-5.85zm41.81 0h-4.8l-.43-1.58c-2.084 1.352-4.516 2.068-7 2.06-4.27 0-6.1-2.93-6.1-7 0-4.75 2.06-6.58 6.82-6.58H177v-2.41c0-2.59-.72-3.5-4.46-3.5-2.18.024-4.35.265-6.48.72l-.72-4.46c2.606-.72 5.296-1.09 8-1.1 7.34 0 9.5 2.59 9.5 8.45l.05 15.4zM177 37.24h-4.32c-1.92 0-2.45.53-2.45 2.3 0 1.77.53 2.35 2.35 2.35 1.55-.02 3.07-.434 4.42-1.2v-3.45zm9.48-6.77c0-5.18 2.3-8.26 7.73-8.26 2.097.02 4.187.244 6.24.67v-9.74l5.86-.82v33.75h-4.66l-.58-2c-2.133 1.595-4.726 2.454-7.39 2.45-4.7 0-7.2-2.79-7.2-8.11v-7.94zm14-2.64c-1.702-.38-3.437-.588-5.18-.62-2.11 0-2.93 1-2.93 3.12v8.26c0 1.92.72 3 2.88 3 1.937-.07 3.787-.816 5.23-2.11V27.83z"></path>
  </g>
</svg>

                </a>
              </div>
              <button class="navbar-toggle" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="buttons hidden-xs">
              <nav class="navigation-links" role="navigation">
                <ul class="main-links nav navbar-nav navbar-right">
                  <li><a href="/intro/index.html">Intro</a></li>
                  <li><a href="/guides/index.html">Guides</a></li>
                  <li><a href="/docs/index.html">Docs</a></li>
                  <li><a href="/api/index.html">API</a></li>
                  <li><a href="/resources.html">Resources</a></li>
                  <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
                  <li><a href="https://demo.nomadproject.io">UI Demo</a></li>
                  <li>
                    <a href="/downloads.html">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
                    </a>
                  </li>
                  <li>
                    <a href="https://github.com/hashicorp/nomad">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-overlay"></div>

<aside class="sidebar" role="navigation">
  <div class="sidebar-header">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 207 60" height="42">
  <g fill="none">
    <path class="top" fill="#25BA81" d="M26.03.01L0 15.05l17.56 10.32 3.56-2.17 8.63 4.82v-10l8.27-4.97v10.02l14.48-8.02v-.04"></path>
    <path class="left" fill="#25BA81" d="M22.75 32.03v9.99l-7.88 5v-20l2.99-1.83L.15 15.05H0v29.96l26.25 15V34.03"></path>
    <path class="right" fill="#1F9967" d="M38.02 23.07v9.95l-6.93 4.01-4.84-3v25.98h.14l26.11-15V15.05l-.49-.01"></path>
    <path class="text" fill="#000" d="M78.49 21.83v24.24h-5.9v-32h8.06l12.14 24.32V14.1h5.9v32h-8.06m22.46.45c-8 0-10.18-4.42-10.18-9.22v-5.9c0-4.8 2.16-9.22 10.18-9.22s10.18 4.42 10.18 9.22v5.91c0 4.79-2.16 9.21-10.18 9.21zm0-19.35c-3.12 0-4.32 1.39-4.32 4v6.29c0 2.64 1.2 4 4.32 4s4.32-1.39 4.32-4v-6.25c0-2.64-1.2-4.04-4.32-4.04zm27.99 18.87V29.75c0-1.25-.53-1.87-1.87-1.87-2.147.252-4.22.932-6.1 2v16.19h-5.86V22.69h4.46l.58 2c2.916-1.46 6.104-2.293 9.36-2.45 1.852-.175 3.616.823 4.42 2.5 2.922-1.495 6.13-2.348 9.41-2.5 3.89 0 5.28 2.74 5.28 6.91v16.92h-5.86V29.75c0-1.25-.53-1.87-1.87-1.87-2.15.234-4.23.915-6.1 2v16.19h-5.85zm41.81 0h-4.8l-.43-1.58c-2.084 1.352-4.516 2.068-7 2.06-4.27 0-6.1-2.93-6.1-7 0-4.75 2.06-6.58 6.82-6.58H177v-2.41c0-2.59-.72-3.5-4.46-3.5-2.18.024-4.35.265-6.48.72l-.72-4.46c2.606-.72 5.296-1.09 8-1.1 7.34 0 9.5 2.59 9.5 8.45l.05 15.4zM177 37.24h-4.32c-1.92 0-2.45.53-2.45 2.3 0 1.77.53 2.35 2.35 2.35 1.55-.02 3.07-.434 4.42-1.2v-3.45zm9.48-6.77c0-5.18 2.3-8.26 7.73-8.26 2.097.02 4.187.244 6.24.67v-9.74l5.86-.82v33.75h-4.66l-.58-2c-2.133 1.595-4.726 2.454-7.39 2.45-4.7 0-7.2-2.79-7.2-8.11v-7.94zm14-2.64c-1.702-.38-3.437-.588-5.18-.62-2.11 0-2.93 1-2.93 3.12v8.26c0 1.92.72 3 2.88 3 1.937-.07 3.787-.816 5.23-2.11V27.83z"></path>
  </g>
</svg>

  </div>

  <ul class="nav sidebar-nav">
    <li><a href="/intro/index.html">Intro</a></li>
    <li><a href="/guides/index.html">Guides</a></li>
    <li><a href="/docs/index.html">Docs</a></li>
    <li><a href="/api/index.html">API</a></li>
    <li><a href="/community.html">Community</a></li>
    <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
    <li><a href="/security.html">Security</a></li>
    <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
  </ul>

  <div class="divider"></div>

  <ul class="external nav sidebar-nav">
    <li>
      <a href="/downloads.html">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h28V0zM13.8 22.9L7 17.3l2-2.4 3.2 2.6V7h3.2v10.5l3.2-2.6 2 2.4L13.8 22.9z"></path>
</svg>
 Download
      </a>
    </li>
    <li>
      <a href="https://github.com/hashicorp/nomad">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
  <path d="M28 0H0v28h11.4c0 0 0-1.3 0-2.4C7.7 26.4 7 23.9 7 23.9 6.4 22.4 5.5 22 5.5 22c-1.2-0.8 0.1-0.8 0.1-0.8 1.3 0.1 2 1.4 2 1.4 1.2 2 3 1.4 3.8 1.1 0.1-0.8 0.5-1.4 0.9-1.8 -2.9-0.3-6-1.5-6-6.5 0-1.4 0.5-2.6 1.3-3.5C7.5 11.5 7 10.2 7.8 8.4c0 0 1.1-0.4 3.6 1.3 1-0.3 2.2-0.4 3.3-0.4 1.1 0 2.2 0.2 3.3 0.4 2.5-1.7 3.6-1.3 3.6-1.3 0.7 1.8 0.3 3.1 0.1 3.5 0.8 0.9 1.3 2.1 1.3 3.5 0 5-3.1 6.1-6 6.5 0.5 0.4 0.9 1.2 0.9 2.4 0 1.8 0 3.7 0 3.7H28V0z"></path>
</svg>
 GitHub
      </a>
    </li>
  </ul>
</aside>


    <div class="container">
  <div class="row">
    <div id="docs-sidebar" class="col-sm-4 col-md-3 col-xs-12 hidden-print" role="complementary">
          <ul class="nav docs-sidenav">
      <li>
        <a href="/api/index.html">Overview</a>
      </li>

      <li>
        <a href="/api/libraries-and-sdks.html">Libraries &amp; SDKs</a>
      </li>

      <li class="active">
        <a href="/api/json-jobs.html">JSON Jobs</a>
      </li>

      <hr>

      <li>
        <a href="/api/acl-policies.html">ACL Policies</a>
      </li>

      <li>
        <a href="/api/acl-tokens.html">ACL Tokens</a>
      </li>

      <li>
        <a href="/api/agent.html">Agent</a>
      </li>

      <li>
        <a href="/api/allocations.html">Allocations</a>
      </li>

      <li>
        <a href="/api/client.html">Client</a>
      </li>

      <li>
        <a href="/api/deployments.html">Deployments</a>
      </li>

      <li>
        <a href="/api/evaluations.html">Evaluations</a>
      </li>

      <li>
        <a href="/api/jobs.html">Jobs</a>
      </li>

      <li>
        <a href="/api/namespaces.html">Namespaces</a>
      </li>

      <li>
        <a href="/api/nodes.html">Nodes</a>
      </li>

      <li>
        <a href="/api/metrics.html">Metrics</a>
      </li>

      <li>
        <a href="/api/operator.html">Operator</a>
      </li>

      <li>
        <a href="/api/quotas.html">Quotas</a>
      </li>

      <li>
        <a href="/api/regions.html">Regions</a>
      </li>

      <li>
        <a href="/api/search.html">Search</a>
      </li>

      <li>
          <a href="/api/sentinel-policies.html">Sentinel Policies</a>
      </li>

      <li>
        <a href="/api/status.html">Status</a>
      </li>

      <li>
        <a href="/api/system.html">System</a>
      </li>

      <li>
        <a href="/api/ui.html">UI</a>
      </li>

      <li>
        <a href="/api/validate.html">Validate</a>
      </li>
    </ul>

    </div>

    <div id="inner" class="col-sm-8 col-md-9 col-xs-12" role="main">

  <h1 id="json-job-specification">
  <a name="json-job-specification" class="anchor" href="#json-job-specification">&raquo;</a>
  JSON Job Specification
</h1>
<p>This guide covers the JSON syntax for submitting jobs to Nomad. A useful command
for generating valid JSON versions of HCL jobs is:</p>
<div class="highlight"><pre class="highlight shell"><code><span class="nv">$ </span>nomad job run <span class="nt">-output</span> my-job.nomad
</code></pre></div><h2 id="syntax">
  <a name="syntax" class="anchor" href="#syntax">&raquo;</a>
  Syntax
</h2>
<p>Below is the JSON representation of the job outputted by <code>$ nomad init</code>:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"Job"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"ID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"service"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Datacenters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"dc1"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"TaskGroups"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
            </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cache"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Migrate"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"HealthCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checks"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"HealthyDeadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">300000000000</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"MaxParallel"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"MinHealthyTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000000000</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"Tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"redis"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Driver"</span><span class="p">:</span><span class="w"> </span><span class="s2">"docker"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"User"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Config"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"redis:3.2"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"port_map"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                        </span><span class="s2">"db"</span><span class="p">:</span><span class="w"> </span><span class="mi">6379</span><span class="w">
                    </span><span class="p">}]</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"Services"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                    </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"redis-cache"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"Tags"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                        </span><span class="s2">"global"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"cache"</span><span class="w">
                    </span><span class="p">],</span><span class="w">
                    </span><span class="s2">"PortLabel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"AddressMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"Checks"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                        </span><span class="s2">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"alive"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tcp"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Command"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Args"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Header"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
                        </span><span class="s2">"Method"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Path"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Protocol"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"PortLabel"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000000000</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"Timeout"</span><span class="p">:</span><span class="w"> </span><span class="mi">2000000000</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"InitialStatus"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"TLSSkipVerify"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"CheckRestart"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="s2">"Limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Grace"</span><span class="p">:</span><span class="w"> </span><span class="mi">30000000000</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"IgnoreWarnings"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}]</span><span class="w">
                </span><span class="p">}],</span><span class="w">
                </span><span class="s2">"Resources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"CPU"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"MemoryMB"</span><span class="p">:</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"Networks"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                        </span><span class="s2">"Device"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"CIDR"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"IP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"MBits"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"DynamicPorts"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                            </span><span class="s2">"Label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db"</span><span class="p">,</span><span class="w">
                            </span><span class="s2">"Value"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
                        </span><span class="p">}]</span><span class="w">
                    </span><span class="p">}]</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="s2">"Leader"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
            </span><span class="p">}],</span><span class="w">
            </span><span class="s2">"RestartPolicy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"Interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">1800000000000</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Delay"</span><span class="p">:</span><span class="w"> </span><span class="mi">15000000000</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fail"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"ReschedulePolicy"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"Attempts"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Delay"</span><span class="p">:</span><span class="w"> </span><span class="mi">30000000000</span><span class="p">,</span><span class="w">
                </span><span class="s2">"DelayFunction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"exponential"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="s2">"MaxDelay"</span><span class="p">:</span><span class="w"> </span><span class="mi">3600000000000</span><span class="p">,</span><span class="w">
                </span><span class="s2">"Unlimited"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"EphemeralDisk"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"SizeMB"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}],</span><span class="w">
        </span><span class="s2">"Update"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"MaxParallel"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"MinHealthyTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000000000</span><span class="p">,</span><span class="w">
            </span><span class="s2">"HealthyDeadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">180000000000</span><span class="p">,</span><span class="w">
            </span><span class="s2">"AutoRevert"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"Canary"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>The example JSON could be submitted as a job using the following:</p>
<div class="highlight"><pre class="highlight plaintext"><code>$ curl -XPUT -d @example.json http://127.0.0.1:4646/v1/job/example
{
  "EvalID": "5d6ded54-0b2a-8858-6583-be5f476dec9d",
  "EvalCreateIndex": 12,
  "JobModifyIndex": 11,
  "Warnings": "",
  "Index": 12,
  "LastContact": 0,
  "KnownLeader": false
}
</code></pre></div><h2 id="syntax-reference">
  <a name="syntax-reference" class="anchor" href="#syntax-reference">&raquo;</a>
  Syntax Reference
</h2>
<p>Following is a syntax reference for the possible keys that are supported and
their default values if any for each type of object.</p>
<h3 id="job">
  <a name="job" class="anchor" href="#job">&raquo;</a>
  Job
</h3>
<p>The <code>Job</code> object supports the following keys:</p>

<ul>
<li><p><a name="allatonce" /><a href="#allatonce"><code>AllAtOnce</code></a> - Controls whether the scheduler can make partial placements if
optimistic scheduling resulted in an oversubscribed node. This does not
control whether all allocations for the job, where all would be the desired
count for each task group, must be placed atomically. This should only be
used for special circumstances. Defaults to <code>false</code>.</p>
</li>
<li><p><a name="constraints" /><a href="#constraints"><code>Constraints</code></a> - A list to define additional constraints where a job can be
run. See the constraint reference for more details.</p>
</li>
<li><p><a name="datacenters" /><a href="#datacenters"><code>Datacenters</code></a> - A list of datacenters in the region which are eligible
for task placement. This must be provided, and does not have a default.</p>
</li>
<li><p><a name="taskgroups" /><a href="#taskgroups"><code>TaskGroups</code></a> - A list to define additional task groups. See the task group
reference for more details.</p>
</li>
<li><p><a name="meta" /><a href="#meta"><code>Meta</code></a> - Annotates the job with opaque metadata.</p>
</li>
<li><p><a name="namespace" /><a href="#namespace"><code>Namespace</code></a> - The namespace to execute the job in, defaults to &quot;default&quot;.
Values other than default are not allowed in non-Enterprise versions of Nomad.</p>
</li>
<li><p><a name="parameterizedjob" /><a href="#parameterizedjob"><code>ParameterizedJob</code></a> - Specifies the job as a parameterized job such that it can
be dispatched against. The <code>ParameterizedJob</code> object supports the following
attributes:</p>

<ul>
<li><a name="metaoptional" /><a href="#metaoptional"><code>MetaOptional</code></a> - Specifies the set of metadata keys that may be provided
when dispatching against the job as a string array.
</li>
<li><a name="metarequired" /><a href="#metarequired"><code>MetaRequired</code></a> - Specifies the set of metadata keys that must be provided
when dispatching against the job as a string array.
</li>
<li><a name="payload" /><a href="#payload"><code>Payload</code></a> - Specifies the requirement of providing a payload when
dispatching against the parameterized job. The options for this field are
&quot;optional&quot;, &quot;required&quot; and &quot;forbidden&quot;. The default value is &quot;optional&quot;.
</li>
</ul>
</li>
<li><p><a name="payload-1" /><a href="#payload-1"><code>Payload</code></a> - The payload may not be set when submitting a job but may appear in
a dispatched job. The <code>Payload</code> will be a base64 encoded string containing the
payload that the job was dispatched with. The <code>payload</code> has a <strong>maximum size
of 16 KiB</strong>.</p>
</li>
<li><p><a name="priority" /><a href="#priority"><code>Priority</code></a> - Specifies the job priority which is used to prioritize
scheduling and access to resources. Must be between 1 and 100 inclusively,
and defaults to 50.</p>
</li>
<li><p><a name="region" /><a href="#region"><code>Region</code></a> - The region to run the job in, defaults to &quot;global&quot;.</p>
</li>
<li><p><a name="type" /><a href="#type"><code>Type</code></a> - Specifies the job type and switches which scheduler
is used. Nomad provides the <code>service</code>, <code>system</code> and <code>batch</code> schedulers,
and defaults to <code>service</code>. To learn more about each scheduler type visit
<a href="/docs/runtime/schedulers.html">here</a></p>
</li>
<li><p><a name="update" /><a href="#update"><code>Update</code></a> - Specifies an update strategy to be applied to all task groups
within the job. When specified both at the job level and the task group level,
the update blocks are merged with the task group&#39;s taking precedence. For more
details on the update stanza, please see below.</p>
</li>
<li><p><a name="periodic" /><a href="#periodic"><code>Periodic</code></a> - <code>Periodic</code> allows the job to be scheduled at fixed times, dates
or intervals. The periodic expression is always evaluated in the UTC
timezone to ensure consistent evaluation when Nomad Servers span multiple
time zones. The <code>Periodic</code> object is optional and supports the following attributes:</p>

<ul>
<li><a name="enabled" /><a href="#enabled"><code>Enabled</code></a> - <code>Enabled</code> determines whether the periodic job will spawn child
jobs.
</li>
<li><a name="timezone" /><a href="#timezone"><code>TimeZone</code></a> - Specifies the time zone to evaluate the next launch interval
against. This is useful when wanting to account for day light savings in
various time zones. The time zone must be parsable by Golang&#39;s
<a href="https://golang.org/pkg/time/#LoadLocation">LoadLocation</a>. The default is
UTC.
</li>
<li><a name="spectype" /><a href="#spectype"><code>SpecType</code></a> - <code>SpecType</code> determines how Nomad is going to interpret the
periodic expression. <code>cron</code> is the only supported <code>SpecType</code> currently.
</li>
<li><a name="spec" /><a href="#spec"><code>Spec</code></a> - A cron expression configuring the interval the job is launched
at. Supports predefined expressions such as &quot;@daily&quot; and &quot;@weekly&quot; See
<a href="https://github.com/gorhill/cronexpr#implementation">here</a> for full
documentation of supported cron specs and the predefined expressions.
</li>
<li><a id="prohibit_overlap"><code>ProhibitOverlap</code></a> - <code>ProhibitOverlap</code> can
be set to true to enforce that the periodic job doesn&#39;t spawn a new
instance of the job if any of the previous jobs are still running. It is
defaulted to false.
</li>
</ul>
<p>An example <code>periodic</code> block:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Periodic"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"Spec"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*/15 - *"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"TimeZone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Europe/Berlin"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"SpecType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cron"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ProhibitOverlap"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></li>
<li><p><a name="reschedulepolicy" /><a href="#reschedulepolicy"><code>ReschedulePolicy</code></a> - Specifies a reschedule policy to be applied to all task groups
within the job. When specified both at the job level and the task group level,
the reschedule blocks are merged, with the task group&#39;s taking precedence. For more
details on <code>ReschedulePolicy</code>, please see below.</p>
</li>
</ul>
<h3 id="task-group">
  <a name="task-group" class="anchor" href="#task-group">&raquo;</a>
  Task Group
</h3>
<p><code>TaskGroups</code> is a list of <code>TaskGroup</code> objects, each supports the following
attributes:</p>

<ul>
<li><p><a name="constraints-1" /><a href="#constraints-1"><code>Constraints</code></a> - This is a list of <code>Constraint</code> objects. See the constraint
reference for more details.</p>
</li>
<li><p><a name="count" /><a href="#count"><code>Count</code></a> - Specifies the number of the task groups that should
be running. Must be non-negative, defaults to one.</p>
</li>
<li><p><a name="meta-1" /><a href="#meta-1"><code>Meta</code></a> - A key-value map that annotates the task group with opaque metadata.</p>
</li>
<li><p><a name="migrate" /><a href="#migrate"><code>Migrate</code></a> - Specifies a migration strategy to be applied during <a href="/docs/commands/node/drain.html">node
drains</a>.</p>

<ul>
<li><a name="healthcheck" /><a href="#healthcheck"><code>HealthCheck</code></a> - One of <code>checks</code> or <code>task_states</code>. Indicates how task health
should be determined: either via Consul health checks or whether the task
was able to run successfully.
</li>
<li><a name="healthydeadline" /><a href="#healthydeadline"><code>HealthyDeadline</code></a> - Specifies duration a task must become healthy within
before it is considered unhealthy.
</li>
<li><a name="maxparallel" /><a href="#maxparallel"><code>MaxParallel</code></a> - Specifies how many allocations may be migrated at once.
</li>
<li><a name="minhealthytime" /><a href="#minhealthytime"><code>MinHealthyTime</code></a> - Specifies duration a task must be considered healthy
before the migration is considered healthy.
</li>
</ul>
</li>
<li><p><a name="name" /><a href="#name"><code>Name</code></a> - The name of the task group. Must be specified.</p>
</li>
<li><p><a name="restartpolicy" /><a href="#restartpolicy"><code>RestartPolicy</code></a> - Specifies the restart policy to be applied to tasks in this group.
If omitted, a default policy for batch and non-batch jobs is used based on the
job type. See the <a href="#restart_policy">restart policy reference</a> for more details.</p>
</li>
<li><p><a name="reschedulepolicy-1" /><a href="#reschedulepolicy-1"><code>ReschedulePolicy</code></a> - Specifies the reschedule policy to be applied to tasks in this group.
If omitted, a default policy is used for batch and service jobs. System jobs are not eligible
for rescheduling. See the <a href="#reschedule_policy">reschedule policy reference</a> for more details.</p>
</li>
<li><p><a name="ephemeraldisk" /><a href="#ephemeraldisk"><code>EphemeralDisk</code></a> - Specifies the group&#39;s ephemeral disk requirements. See the
<a href="#ephemeral_disk">ephemeral disk reference</a> for more details.</p>
</li>
<li><p><a name="update-1" /><a href="#update-1"><code>Update</code></a> - Specifies an update strategy to be applied to all task groups
within the job. When specified both at the job level and the task group level,
the update blocks are merged with the task group&#39;s taking precedence. For more
details on the update stanza, please see below.</p>
</li>
<li><p><a name="tasks" /><a href="#tasks"><code>Tasks</code></a> - A list of <code>Task</code> object that are part of the task group.</p>
</li>
</ul>
<h3 id="task">
  <a name="task" class="anchor" href="#task">&raquo;</a>
  Task
</h3>
<p>The <code>Task</code> object supports the following keys:</p>

<ul>
<li><p><a name="artifacts" /><a href="#artifacts"><code>Artifacts</code></a> - <code>Artifacts</code> is a list of <code>Artifact</code> objects which define
artifacts to be downloaded before the task is run. See the artifacts
reference for more details.</p>
</li>
<li><p><a name="config" /><a href="#config"><code>Config</code></a> - A map of key-value configuration passed into the driver
to start the task. The details of configurations are specific to
each driver.</p>
</li>
<li><p><a name="constraints-2" /><a href="#constraints-2"><code>Constraints</code></a> - This is a list of <code>Constraint</code> objects. See the constraint
reference for more details.</p>
</li>
<li><p><a name="dispatchpayload" /><a href="#dispatchpayload"><code>DispatchPayload</code></a> - Configures the task to have access to dispatch payloads.
The <code>DispatchPayload</code> object supports the following attributes:</p>

<ul>
<li><a name="file" /><a href="#file"><code>File</code></a> - Specifies the file name to write the content of dispatch payload
to. The file is written relative to the task&#39;s local directory.
</li>
</ul>
</li>
<li><p><a name="driver" /><a href="#driver"><code>Driver</code></a> - Specifies the task driver that should be used to run the
task. See the <a href="/docs/drivers/index.html">driver documentation</a> for what
is available. Examples include <code>docker</code>, <code>qemu</code>, <code>java</code>, and <code>exec</code>.</p>
</li>
<li><p><a name="env" /><a href="#env"><code>Env</code></a> - A map of key-value representing environment variables that
will be passed along to the running process. Nomad variables are
interpreted when set in the environment variable values. See the table of
interpreted variables <a href="/docs/runtime/interpolation.html">here</a>.</p>
<p>For example the below environment map will be reinterpreted:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Env"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"NODE_CLASS"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"${nomad.class}"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></li>
<li><p><a name="killsignal" /><a href="#killsignal"><code>KillSignal</code></a> - Specifies a configurable kill signal for a task, where the
default is SIGINT. Note that this is only supported for drivers which accept
sending signals (currently <code>docker</code>, <code>exec</code>, <code>raw_exec</code>, and <code>java</code> drivers).</p>
</li>
<li><p><a name="killtimeout" /><a href="#killtimeout"><code>KillTimeout</code></a> - <code>KillTimeout</code> is a time duration in nanoseconds. It can be
used to configure the time between signaling a task it will be killed and
actually killing it. Drivers first sends a task the <code>SIGINT</code> signal and then
sends <code>SIGTERM</code> if the task doesn&#39;t die after the <code>KillTimeout</code> duration has
elapsed. The default <code>KillTimeout</code> is 5 seconds.</p>
</li>
<li><p><a name="leader" /><a href="#leader"><code>Leader</code></a> - Specifies whether the task is the leader task of the task group. If
set to true, when the leader task completes, all other tasks within the task
group will be gracefully shutdown.</p>
</li>
<li><p><a name="logconfig" /><a href="#logconfig"><code>LogConfig</code></a> - This allows configuring log rotation for the <code>stdout</code> and <code>stderr</code>
buffers of a Task. See the log rotation reference below for more details.</p>
</li>
<li><p><a name="meta-2" /><a href="#meta-2"><code>Meta</code></a> - Annotates the task group with opaque metadata.</p>
</li>
<li><p><a name="name-1" /><a href="#name-1"><code>Name</code></a> - The name of the task. This field is required.</p>
</li>
<li><p><a name="resources" /><a href="#resources"><code>Resources</code></a> - Provides the resource requirements of the task.
See the resources reference for more details.</p>
</li>
<li><p><a name="services" /><a href="#services"><code>Services</code></a> - <code>Services</code> is a list of <code>Service</code> objects. Nomad integrates with
Consul for service discovery. A <code>Service</code> object represents a routable and
discoverable service on the network. Nomad automatically registers when a task
is started and de-registers it when the task transitions to the dead state.
<a href="/docs/service-discovery/index.html">Click here</a> to learn more about
services. Below is the fields in the <code>Service</code> object:</p>

<ul>
<li><a name="name-2" /><a href="#name-2"><code>Name</code></a>: An explicit name for the Service. Nomad will replace <code>${JOB}</code>,
<code>${TASKGROUP}</code> and <code>${TASK}</code> by the name of the job, task group or task,
respectively. <code>${BASE}</code> expands to the equivalent of
<code>${JOB}-${TASKGROUP}-${TASK}</code>, and is the default name for a Service.
Each service defined for a given task must have a distinct name, so if
a task has multiple services only one of them can use the default name
and the others must be explicitly named. Names must adhere to
<a href="https://tools.ietf.org/html/rfc1123#section-2">RFC-1123 2.1</a> and are
limited to alphanumeric and hyphen characters (i.e. <code>[a-z0-9\-]</code>), and be
less than 64 characters in length.
</li>
<li><a name="tags" /><a href="#tags"><code>Tags</code></a>: A list of string tags associated with this Service. String
interpolation is supported in tags.
</li>
<li><a name="canarytags" /><a href="#canarytags"><code>CanaryTags</code></a>: A list of string tags associated with this Service while it
is a canary. Once the canary is promoted, the registered tags will be
updated to the set defined in the <code>Tags</code> field. String interpolation is
supported in tags.
</li>
<li><a name="portlabel" /><a href="#portlabel"><code>PortLabel</code></a>: <code>PortLabel</code> is an optional string and is used to associate
a port with the service.  If specified, the port label must match one
defined in the resources block.  This could be a label of either a
dynamic or a static port.
</li>
<li><a name="addressmode" /><a href="#addressmode"><code>AddressMode</code></a>: Specifies what address (host or driver-specific) this
service should advertise.  This setting is supported in Docker since
Nomad 0.6 and rkt since Nomad 0.7. Valid options are:

<ul>
<li><a name="auto" /><a href="#auto"><code>auto</code></a> - Allows the driver to determine whether the host or driver
address should be used. Defaults to <code>host</code> and only implemented by
Docker. If you use a Docker network plugin such as weave, Docker will
automatically use its address.
</li>
<li><a name="driver-1" /><a href="#driver-1"><code>driver</code></a> - Use the IP specified by the driver, and the port specified
in a port map. A numeric port may be specified since port maps aren&#39;t
required by all network plugins. Useful for advertising SDN and
overlay network addresses. Task will fail if driver network cannot be
determined. Only implemented for Docker and rkt.
</li>
<li><a name="host" /><a href="#host"><code>host</code></a> - Use the host IP and port.
</li>
</ul>
</li>
<li><p><a name="checks" /><a href="#checks"><code>Checks</code></a>: <code>Checks</code> is an array of check objects. A check object defines a
health check associated with the service. Nomad supports the <code>script</code>,
<code>http</code> and <code>tcp</code> Consul Checks. Script checks are not supported for the
qemu driver since the Nomad client doesn&#39;t have access to the file system
of a task using the Qemu driver.</p>

<ul>
<li><a name="type-1" /><a href="#type-1"><code>Type</code></a>:  This indicates the check types supported by Nomad. Valid
options are currently <code>script</code>, <code>http</code> and <code>tcp</code>.
</li>
<li><a name="name-3" /><a href="#name-3"><code>Name</code></a>: The name of the health check.
</li>
</ul>
</li>
<li><p><a name="addressmode-1" /><a href="#addressmode-1"><code>AddressMode</code></a>: Same as <code>AddressMode</code> on <code>Service</code>.  Unlike services,
checks do not have an <code>auto</code> address mode as there&#39;s no way for
Nomad to know which is the best address to use for checks. Consul
needs access to the address for any HTTP or TCP checks. Added in
Nomad 0.7.1. Unlike <code>PortLabel</code>, this setting is <em>not</em> inherited
   from the <code>Service</code>.</p>
</li>
<li><p><a name="portlabel-1" /><a href="#portlabel-1"><code>PortLabel</code></a>: Specifies the label of the port on which the check will
be performed. Note this is the <em>label</em> of the port and not the port
number unless <code>AddressMode: &quot;driver&quot;</code>. The port label must match one
defined in the Network stanza. If a port value was declared on the
<code>Service</code>, this will inherit from that value if not supplied. If
supplied, this value takes precedence over the <code>Service.PortLabel</code>
value. This is useful for services which operate on multiple ports.
<code>http</code> and <code>tcp</code> checks require a port while <code>script</code> checks do not.
Checks will use the host IP and ports by default. In Nomad 0.7.1 or
later numeric ports may be used if <code>AddressMode: &quot;driver&quot;</code> is set on
  the check.</p>
</li>
<li><p><a name="header" /><a href="#header"><code>Header</code></a>: Headers for HTTP checks. Should be an object where the
values are an array of values. Headers will be written once for each
   value.</p>

<ul>
<li><a name="interval" /><a href="#interval"><code>Interval</code></a>: This indicates the frequency of the health checks that
Consul will perform.
</li>
<li><a name="timeout" /><a href="#timeout"><code>Timeout</code></a>: This indicates how long Consul will wait for a health
check query to succeed.
</li>
<li><a name="method" /><a href="#method"><code>Method</code></a>: The HTTP method to use for HTTP checks. Defaults to GET.
</li>
<li><a name="path" /><a href="#path"><code>Path</code></a>: The path of the HTTP endpoint which Consul will query to query
the health of a service if the type of the check is <code>http</code>. Nomad
will add the IP of the service and the port, users are only required
to add the relative URL of the health check endpoint. Absolute paths
are not allowed.
</li>
<li><a name="protocol" /><a href="#protocol"><code>Protocol</code></a>: This indicates the protocol for the HTTP checks. Valid
options are <code>http</code> and <code>https</code>. We default it to <code>http</code>.
</li>
<li><a name="command" /><a href="#command"><code>Command</code></a>: This is the command that the Nomad client runs for doing
script based health check.
</li>
<li><a name="args" /><a href="#args"><code>Args</code></a>: Additional arguments to the <code>command</code> for script based health
checks.
</li>
</ul>
</li>
<li><p><a name="tlsskipverify" /><a href="#tlsskipverify"><code>TLSSkipVerify</code></a>: If true, Consul will not attempt to verify the
certificate when performing HTTPS checks. Requires Consul &gt;= 0.7.2.</p>

<ul>
<li><a name="checkrestart" /><a href="#checkrestart"><code>CheckRestart</code></a>: <code>CheckRestart</code> is an object which enables
restarting of tasks based upon Consul health checks.

<ul>
<li><a name="limit" /><a href="#limit"><code>Limit</code></a>: The number of unhealthy checks allowed before the
service is restarted. Defaults to <code>0</code> which disables
health-based restarts.
</li>
<li><a name="grace" /><a href="#grace"><code>Grace</code></a>: The duration to wait after a task starts or restarts
before counting unhealthy checks count against the limit.
Defaults to &quot;1s&quot;.
</li>
<li><a name="ignorewarnings" /><a href="#ignorewarnings"><code>IgnoreWarnings</code></a>: Treat checks that are warning as passing.
Defaults to false which means warnings are considered unhealthy.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a name="shutdowndelay" /><a href="#shutdowndelay"><code>ShutdownDelay</code></a> - Specifies the duration to wait when killing a task between
removing it from Consul and sending it a shutdown signal. Ideally services
would fail healthchecks once they receive a shutdown signal. Alternatively
<code>ShutdownDelay</code> may be set to give in flight requests time to complete before
shutting down.</p>
</li>
<li><p><a name="templates" /><a href="#templates"><code>Templates</code></a> - Specifies the set of <a href="#template"><code>Template</code></a> objects to render for the task.
Templates can be used to inject both static and dynamic configuration with
data populated from environment variables, Consul and Vault.</p>
</li>
<li><p><a name="user" /><a href="#user"><code>User</code></a> - Set the user that will run the task. It defaults to the same user
the Nomad client is being run as. This can only be set on Linux platforms.</p>
</li>
</ul>
<h3 id="resources-1">
  <a name="resources-1" class="anchor" href="#resources-1">&raquo;</a>
  Resources
</h3>
<p>The <code>Resources</code> object supports the following keys:</p>

<ul>
<li><p><a name="cpu" /><a href="#cpu"><code>CPU</code></a> - The CPU required in MHz.</p>
</li>
<li><p><a name="iops" /><a href="#iops"><code>IOPS</code></a> - The number of IOPS required given as a weight between 10-1000.</p>
</li>
<li><p><a name="memorymb" /><a href="#memorymb"><code>MemoryMB</code></a> - The memory required in MB.</p>
</li>
<li><p><a name="networks" /><a href="#networks"><code>Networks</code></a> - A list of network objects.</p>
</li>
</ul>
<p>The Network object supports the following keys:</p>

<ul>
<li><a name="mbits" /><a href="#mbits"><code>MBits</code></a> - The number of MBits in bandwidth required.
</li>
</ul>
<p>Nomad can allocate two types of ports to a task - Dynamic and Static/Reserved
ports. A network object allows the user to specify a list of <code>DynamicPorts</code> and
<code>ReservedPorts</code>. Each object supports the following attributes:</p>

<ul>
<li><a name="value" /><a href="#value"><code>Value</code></a> - The port number for static ports. If the port is dynamic, then this
attribute is ignored.
</li>
<li><a name="label" /><a href="#label"><code>Label</code></a> - The label to annotate a port so that it can be referred in the
service discovery block or environment variables.
</li>
</ul>
<p><a id="ephemeral_disk"></a></p>
<h3 id="ephemeral-disk">
  <a name="ephemeral-disk" class="anchor" href="#ephemeral-disk">&raquo;</a>
  Ephemeral Disk
</h3>
<p>The <code>EphemeralDisk</code> object supports the following keys:</p>

<ul>
<li><p><a name="migrate-1" /><a href="#migrate-1"><code>Migrate</code></a> - Specifies that the Nomad client should make a best-effort attempt
to migrate the data from a remote machine if placement cannot be made on the
original node. During data migration, the task will block starting until the
data migration has completed. Value is a boolean and the default is false.</p>
</li>
<li><p><a name="sizemb" /><a href="#sizemb"><code>SizeMB</code></a> - Specifies the size of the ephemeral disk in MB. Default is 300.</p>
</li>
<li><p><a name="sticky" /><a href="#sticky"><code>Sticky</code></a> - Specifies that Nomad should make a best-effort attempt to place the
updated allocation on the same machine. This will move the <code>local/</code> and
<code>alloc/data</code> directories to the new allocation. Value is a boolean and the
default is false.</p>
</li>
</ul>
<p><a id="reschedule_policy"></a></p>
<h3 id="reschedule-policy">
  <a name="reschedule-policy" class="anchor" href="#reschedule-policy">&raquo;</a>
  Reschedule Policy
</h3>
<p>The <code>ReschedulePolicy</code> object supports the following keys:</p>

<ul>
<li><p><a name="attempts" /><a href="#attempts"><code>Attempts</code></a> - <code>Attempts</code> is the number of reschedule attempts allowed
in an <code>Interval</code>.</p>
</li>
<li><p><a name="interval-1" /><a href="#interval-1"><code>Interval</code></a> - <code>Interval</code> is a time duration that is specified in nanoseconds.
The <code>Interval</code> is a sliding window within which at most <code>Attempts</code> number
of reschedule attempts are permitted.</p>
</li>
<li><p><a name="delay" /><a href="#delay"><code>Delay</code></a> - A duration to wait before attempting rescheduling. It is specified in
nanoseconds.</p>
</li>
<li><p><a name="delayfunction" /><a href="#delayfunction"><code>DelayFunction</code></a> - Specifies the function that is used to calculate subsequent reschedule delays.
The initial delay is specified by the <code>Delay</code> parameter. Allowed values for <code>DelayFunction</code> are listed below:</p>

<ul>
<li><a name="constant" /><a href="#constant"><code>constant</code></a> - The delay between reschedule attempts stays at the <code>Delay</code> value.
</li>
<li><a name="exponential" /><a href="#exponential"><code>exponential</code></a> - The delay between reschedule attempts doubles.
</li>
<li><a name="fibonacci" /><a href="#fibonacci"><code>fibonacci</code></a> - The delay between reschedule attempts is calculated by adding the two most recent
delays applied. For example if <code>Delay</code> is set to 5 seconds, the next five reschedule attempts  will be
delayed by 5 seconds, 5 seconds, 10 seconds, 15 seconds, and 25 seconds respectively.
</li>
</ul>
</li>
<li><p><a name="maxdelay" /><a href="#maxdelay"><code>MaxDelay</code></a>  - <code>MaxDelay</code> is an upper bound on the delay beyond which it will not increase. This parameter is used when
<code>DelayFunction</code> is <code>exponential</code> or <code>fibonacci</code>, and is ignored when <code>constant</code> delay is used.</p>
</li>
<li><p><a name="unlimited" /><a href="#unlimited"><code>Unlimited</code></a> - <code>Unlimited</code> enables unlimited reschedule attempts. If this is set to true
the <code>Attempts</code> and <code>Interval</code> fields are not used.</p>
</li>
</ul>
<p><a id="restart_policy"></a></p>
<h3 id="restart-policy">
  <a name="restart-policy" class="anchor" href="#restart-policy">&raquo;</a>
  Restart Policy
</h3>
<p>The <code>RestartPolicy</code> object supports the following keys:</p>

<ul>
<li><p><a name="attempts-1" /><a href="#attempts-1"><code>Attempts</code></a> - <code>Attempts</code> is the number of restarts allowed in an <code>Interval</code>.</p>
</li>
<li><p><a name="interval-2" /><a href="#interval-2"><code>Interval</code></a> - <code>Interval</code> is a time duration that is specified in nanoseconds.
The <code>Interval</code> begins when the first task starts and ensures that only
<code>Attempts</code> number of restarts happens within it. If more than <code>Attempts</code>
number of failures happen, behavior is controlled by <code>Mode</code>.</p>
</li>
<li><p><a name="delay-1" /><a href="#delay-1"><code>Delay</code></a> - A duration to wait before restarting a task. It is specified in
nanoseconds. A random jitter of up to 25% is added to the delay.</p>
</li>
<li><p><a name="mode" /><a href="#mode"><code>Mode</code></a> - <code>Mode</code> is given as a string and controls the behavior when the task
fails more than <code>Attempts</code> times in an <code>Interval</code>. Possible values are listed
below:</p>

<ul>
<li><a name="delay-2" /><a href="#delay-2"><code>delay</code></a> - <code>delay</code> will delay the next restart until the next <code>Interval</code> is
reached.
</li>
<li><a name="fail" /><a href="#fail"><code>fail</code></a> - <code>fail</code> will not restart the task again.
</li>
</ul>
</li>
</ul>
<h3 id="update-2">
  <a name="update-2" class="anchor" href="#update-2">&raquo;</a>
  Update
</h3>
<p>Specifies the task group update strategy. When omitted, rolling updates are
disabled. The update stanza can be specified at the job or task group level.
When specified at the job, the update stanza is inherited by all task groups.
When specified in both the job and in a task group, the stanzas are merged with
the task group&#39;s taking precedence. The <code>Update</code> object supports the following
attributes:</p>

<ul>
<li><p><a name="maxparallel-1" /><a href="#maxparallel-1"><code>MaxParallel</code></a> - <code>MaxParallel</code> is given as an integer value and specifies
the number of tasks that can be updated at the same time.</p>
</li>
<li><p><a name="healthcheck-1" /><a href="#healthcheck-1"><code>HealthCheck</code></a> - Specifies the mechanism in which allocations health is
determined. The potential values are:</p>

<ul>
<li>&quot;checks&quot; - Specifies that the allocation should be considered healthy when
all of its tasks are running and their associated [checks][] are healthy,
and unhealthy if any of the tasks fail or not all checks become healthy.
This is a superset of &quot;task_states&quot; mode.
</li>
<li>&quot;task_states&quot; - Specifies that the allocation should be considered healthy
when all its tasks are running and unhealthy if tasks fail.
</li>
<li>&quot;manual&quot; - Specifies that Nomad should not automatically determine health
and that the operator will specify allocation health using the <a href="/api/deployments.html#set-allocation-health-in-deployment">HTTP
API</a>.
</li>
</ul>
</li>
<li><p><a name="minhealthytime-1" /><a href="#minhealthytime-1"><code>MinHealthyTime</code></a> - Specifies the minimum time the allocation must be in the
healthy state before it is marked as healthy and unblocks further allocations
from being updated.</p>
</li>
<li><p><a name="healthydeadline-1" /><a href="#healthydeadline-1"><code>HealthyDeadline</code></a> - Specifies the deadline in which the allocation must be
marked as healthy after which the allocation is automatically transitioned to
unhealthy.</p>
</li>
<li><p><a name="progressdeadline" /><a href="#progressdeadline"><code>ProgressDeadline</code></a> - Specifies the deadline in which an allocation must be
marked as healthy. The deadline begins when the first allocation for the
deployment is created and is reset whenever an allocation as part of the
deployment transitions to a healthy state. If no allocation transitions to the
healthy state before the progress deadline, the deployment is marked as
failed. If the <code>progress_deadline</code> is set to <code>0</code>, the first allocation to be
marked as unhealthy causes the deployment to fail.</p>
</li>
<li><p><a name="autorevert" /><a href="#autorevert"><code>AutoRevert</code></a> - Specifies if the job should auto-revert to the last stable job
on deployment failure. A job is marked as stable if all the allocations as
part of its deployment were marked healthy.</p>
</li>
<li><p><a name="canary" /><a href="#canary"><code>Canary</code></a> - Specifies that changes to the job that would result in destructive
updates should create the specified number of canaries without stopping any
previous allocations. Once the operator determines the canaries are healthy,
they can be promoted which unblocks a rolling update of the remaining
allocations at a rate of <code>max_parallel</code>.</p>
</li>
<li><p><a name="stagger" /><a href="#stagger"><code>Stagger</code></a> - Specifies the delay between migrating allocations off nodes marked
for draining.</p>
</li>
</ul>
<p>An example <code>Update</code> block:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Update"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"MaxParallel"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="s2">"HealthCheck"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checks"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"MinHealthyTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">15000000000</span><span class="p">,</span><span class="w">
        </span><span class="s2">"HealthyDeadline"</span><span class="p">:</span><span class="w"> </span><span class="mi">180000000000</span><span class="p">,</span><span class="w">
        </span><span class="s2">"AutoRevert"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Canary"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id="constraint">
  <a name="constraint" class="anchor" href="#constraint">&raquo;</a>
  Constraint
</h3>
<p>The <code>Constraint</code> object supports the following keys:</p>

<ul>
<li><p><a name="ltarget" /><a href="#ltarget"><code>LTarget</code></a> - Specifies the attribute to examine for the
constraint. See the table of attributes <a href="/docs/runtime/interpolation.html#interpreted_node_vars">here</a>.</p>
</li>
<li><p><a name="rtarget" /><a href="#rtarget"><code>RTarget</code></a> - Specifies the value to compare the attribute against.
This can be a literal value, another attribute or a regular expression if
the <code>Operator</code> is in &quot;regexp&quot; mode.</p>
</li>
<li><p><a name="operand" /><a href="#operand"><code>Operand</code></a> - Specifies the test to be performed on the two targets. It takes on the
following values:</p>

<ul>
<li><a name="regexp" /><a href="#regexp"><code>regexp</code></a> - Allows the <code>RTarget</code> to be a regular expression to be matched.
</li>
<li><a name="set_contains" /><a href="#set_contains"><code>set_contains</code></a> - Allows the <code>RTarget</code> to be a comma separated list of values
that should be contained in the LTarget&#39;s value.
</li>
<li><p><a name="distinct_hosts" /><a href="#distinct_hosts"><code>distinct_hosts</code></a> - If set, the scheduler will not co-locate any task groups on the same
machine. This can be specified as a job constraint which applies the
constraint to all task groups in the job, or as a task group constraint which
scopes the effect to just that group. The constraint may not be
specified at the task level.</p>
<p>Placing the constraint at both the job level and at the task group level is
redundant since when placed at the job level, the constraint will be applied
to all task groups. When specified, <code>LTarget</code> and <code>RTarget</code> should be
omitted.</p>
</li>
<li><p><a name="distinct_property" /><a href="#distinct_property"><code>distinct_property</code></a> - If set, the scheduler selects nodes that have a
distinct value of the specified property. The <code>RTarget</code> specifies how
many allocations are allowed to share the value of a property. The
<code>RTarget</code> must be 1 or greater and if omitted, defaults to 1. This can
be specified as a job constraint which applies the constraint to all
task groups in the job, or as a task group constraint which scopes the
effect to just that group. The constraint may not be specified at the
task level.</p>
<p>Placing the constraint at both the job level and at the task group level is
redundant since when placed at the job level, the constraint will be applied
to all task groups. When specified, <code>LTarget</code> should be the property
that should be distinct and <code>RTarget</code> should be omitted.</p>
</li>
<li><p>Comparison Operators - <code>=</code>, <code>==</code>, <code>is</code>, <code>!=</code>, <code>not</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>. The
ordering is compared lexically.</p>
</li>
</ul>
</li>
</ul>
<h3 id="log-rotation">
  <a name="log-rotation" class="anchor" href="#log-rotation">&raquo;</a>
  Log Rotation
</h3>
<p>The <code>LogConfig</code> object configures the log rotation policy for a task&#39;s <code>stdout</code> and
<code>stderr</code>. The <code>LogConfig</code> object supports the following attributes:</p>

<ul>
<li><p><a name="maxfiles" /><a href="#maxfiles"><code>MaxFiles</code></a> - The maximum number of rotated files Nomad will retain for
<code>stdout</code> and <code>stderr</code>, each tracked individually.</p>
</li>
<li><p><a name="maxfilesizemb" /><a href="#maxfilesizemb"><code>MaxFileSizeMB</code></a> - The size of each rotated file. The size is specified in
<code>MB</code>.</p>
</li>
</ul>
<p>If the amount of disk resource requested for the task is less than the total
amount of disk space needed to retain the rotated set of files, Nomad will return
a validation error when a job is submitted.</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"LogConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"MaxFiles"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="s2">"MaxFileSizeMB"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>In the above example we have asked Nomad to retain 3 rotated files for both
<code>stderr</code> and <code>stdout</code> and size of each file is 10 MB. The minimum disk space that
would be required for the task would be 60 MB.</p>
<h3 id="artifact">
  <a name="artifact" class="anchor" href="#artifact">&raquo;</a>
  Artifact
</h3>
<p>Nomad downloads artifacts using
<a href="https://github.com/hashicorp/go-getter"><code>go-getter</code></a>. The <code>go-getter</code> library
allows downloading of artifacts from various sources using a URL as the input
source. The key-value pairs given in the <code>options</code> block map directly to
parameters appended to the supplied <code>source</code> URL. These are then used by
<code>go-getter</code> to appropriately download the artifact. <code>go-getter</code> also has a CLI
tool to validate its URL and can be used to check if the Nomad <code>artifact</code> is
valid.</p>
<p>Nomad allows downloading <code>http</code>, <code>https</code>, and <code>S3</code> artifacts. If these artifacts
are archives (zip, tar.gz, bz2, etc.), these will be unarchived before the task
is started.</p>
<p>The <code>Artifact</code> object supports the following keys:</p>

<ul>
<li><p><a name="gettersource" /><a href="#gettersource"><code>GetterSource</code></a> - The path to the artifact to download.</p>
</li>
<li><p><a name="relativedest" /><a href="#relativedest"><code>RelativeDest</code></a> - An optional path to download the artifact into relative to the
root of the task&#39;s directory. If omitted, it will default to <code>local/</code>.</p>
</li>
<li><p><a name="getteroptions" /><a href="#getteroptions"><code>GetterOptions</code></a> - A <code>map[string]string</code> block of options for <code>go-getter</code>.
Full documentation of supported options are available
<a href="https://github.com/hashicorp/go-getter/tree/ef5edd3d8f6f482b775199be2f3734fd20e04d4a#protocol-specific-options-1">here</a>.
An example is given below:</p>
</li>
</ul>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"GetterOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"checksum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"md5:c4aa853ad2215426eb7d70a21922e794"</span><span class="p">,</span><span class="w">

    </span><span class="s2">"aws_access_key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;id&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"aws_access_key_secret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;secret&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"aws_access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;token&gt;"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>An example of downloading and unzipping an archive is as simple as:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Artifacts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"GetterSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/my.zip"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"GetterOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"checksum"</span><span class="p">:</span><span class="w"> </span><span class="s2">"md5:7f4b3e3b4dd5150d4e5aaaa5efada4c3"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id="s3-examples">
  <a name="s3-examples" class="anchor" href="#s3-examples">&raquo;</a>
  S3 examples
</h4>
<p>S3 has several different types of addressing and more detail can be found
<a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingBucket.html#access-bucket-intro">here</a></p>
<p>S3 region specific endpoints can be found
<a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region">here</a></p>
<p>Path based style:</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Artifacts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"GetterSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s3-us-west-2.amazonaws.com/my-bucket-example/my_app.tar.gz"</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>or to override automatic detection in the URL, use the S3-specific syntax</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Artifacts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"GetterSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3::https://s3-eu-west-1.amazonaws.com/my-bucket-example/my_app.tar.gz"</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>Virtual hosted based style</p>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Artifacts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"GetterSource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"my-bucket-example.s3-eu-west-1.amazonaws.com/my_app.tar.gz"</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id="template">
  <a name="template" class="anchor" href="#template">&raquo;</a>
  Template
</h3>
<p>The <code>Template</code> block instantiates an instance of a template renderer. This
creates a convenient way to ship configuration files that are populated from
environment variables, Consul data, Vault secrets, or just general
configurations within a Nomad task.</p>
<p>Nomad utilizes a tool called <a href="https://github.com/hashicorp/consul-template" title="Consul Template by HashiCorp">Consul Template</a>. Since Nomad v0.5.3, the
template can reference <a href="/docs/runtime/environment.html" title="Nomad Runtime Environment">Nomad&#39;s runtime environment variables</a>. For a full
list of the API template functions, please refer to the <a href="https://github.com/hashicorp/consul-template" title="Consul Template by HashiCorp">Consul Template
README</a>.</p>
<p><code>Template</code> object supports following attributes:</p>

<ul>
<li><p><a name="changemode" /><a href="#changemode"><code>ChangeMode</code></a> - Specifies the behavior Nomad should take if the rendered
template changes. The default value is <code>&quot;restart&quot;</code>. The possible values are:</p>

<ul>
<li><a name="quot-noop-quot-" /><a href="#quot-noop-quot-"><code>&quot;noop&quot;</code></a> - take no action (continue running the task)
</li>
<li><a name="quot-restart-quot-" /><a href="#quot-restart-quot-"><code>&quot;restart&quot;</code></a> - restart the task
</li>
<li><a name="quot-signal-quot-" /><a href="#quot-signal-quot-"><code>&quot;signal&quot;</code></a> - send a configurable signal to the task
</li>
</ul>
</li>
<li><p><a name="changesignal" /><a href="#changesignal"><code>ChangeSignal</code></a> - Specifies the signal to send to the task as a string like
&quot;SIGUSR1&quot; or &quot;SIGINT&quot;. This option is required if the <code>ChangeMode</code> is
<code>signal</code>.</p>
</li>
<li><p><a name="destpath" /><a href="#destpath"><code>DestPath</code></a> - Specifies the location where the resulting template should be
rendered, relative to the task directory.</p>
</li>
<li><p><a name="embeddedtmpl" /><a href="#embeddedtmpl"><code>EmbeddedTmpl</code></a> -  Specifies the raw template to execute. One of <code>SourcePath</code>
or <code>EmbeddedTmpl</code> must be specified, but not both. This is useful for smaller
templates, but we recommend using <code>SourcePath</code> for larger templates.</p>
</li>
<li><p><a name="envvars" /><a href="#envvars"><code>Envvars</code></a> - Specifies the template should be read back as environment
variables for the task.</p>
</li>
<li><p><a name="leftdelim" /><a href="#leftdelim"><code>LeftDelim</code></a> - Specifies the left delimiter to use in the template. The default
is &quot;{{&quot; for some templates, it may be easier to use a different delimiter that
does not conflict with the output file itself.</p>
</li>
<li><p><a name="perms" /><a href="#perms"><code>Perms</code></a> - Specifies the rendered template&#39;s permissions. File permissions are
given as octal of the Unix file permissions <code>rwxrwxrwx</code>.</p>
</li>
<li><p><a name="rightdelim" /><a href="#rightdelim"><code>RightDelim</code></a> - Specifies the right delimiter to use in the template. The default
is &quot;}}&quot; for some templates, it may be easier to use a different delimiter that
does not conflict with the output file itself.</p>
</li>
<li><p><a name="sourcepath" /><a href="#sourcepath"><code>SourcePath</code></a> - Specifies the path to the template to be rendered. <code>SourcePath</code>
is mutually exclusive with <code>EmbeddedTmpl</code> attribute. The source can be fetched
using an <a href="#artifact"><code>Artifact</code></a> resource. The template must exist on the
machine prior to starting the task; it is not possible to reference a template
inside of a Docker container, for example.</p>
</li>
<li><p><a name="splay" /><a href="#splay"><code>Splay</code></a> - Specifies a random amount of time to wait between 0 ms and the given
splay value before invoking the change mode. Should be specified in
nanoseconds.</p>
</li>
<li><p><a name="vaultgrace" /><a href="#vaultgrace"><code>VaultGrace</code></a> - Specifies the grace period between lease renewal and secret
re-acquisition. When renewing a secret, if the remaining lease is less than or
equal to the configured grace, the template will request a new credential.
This prevents Vault from revoking the secret at its expiration and the task
having a stale secret. If the grace is set to a value that is higher than your
default TTL or max TTL, the template will always read a new secret. If the
task defines several templates, the <code>vault_grace</code> will be set to the lowest
value across all the templates.</p>
</li>
</ul>
<div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"Templates"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"SourcePath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local/config.conf.tpl"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"DestPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local/config.conf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"EmbeddedTmpl"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ChangeMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"signal"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ChangeSignal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SIGUSR1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Splay"</span><span class="p">:</span><span class="w"> </span><span class="mi">5000000000</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>

    </div>
  </div>
</div>


    <div id="footer" class="navigation hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <ul class="footer-links nav navbar-nav">
              <li><a href="/intro/index.html">Intro</a></li>
              <li><a href="/guides/index.html">Guides</a></li>
              <li><a href="/docs/index.html">Docs</a></li>
              <li><a href="/api/index.html">API</a></li>
              <li><a href="/resources.html">Resources</a></li>
              <li><a href="https://www.hashicorp.com/products/nomad/?utm_source=oss&utm_medium=header-nav&utm_campaign=nomad">Enterprise</a></li>
              <li><a href="https://demo.nomadproject.io">UI Demo</a></li>
              <li><a href="https://www.hashicorp.com/privacy">Privacy</a></li>
              <li><a href="/security.html">Security</a></li>
              <li><a href="/assets/files/press-kit.zip">Press Kit</a></li>
            </ul>
            <ul class="footer-links nav navbar-nav navbar-right">
              <li><a href="https://github.com/hashicorp/nomad/blob/master/website/source/api/json-jobs.html.md">Edit this page</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Product",
        "name": "Nomad",
        "alternateName": "Nomad by HashiCorp",
        "manufacturer": "HashiCorp",
        "url": "https://www.nomadproject.io",
        "logo": "https://www.nomadproject.io/assets/images/logo-hashicorp-039941e4.svg",
        "sameAs": [
          "https://github.com/hashicorp/nomad"
        ]
      }
    </script>
  </body>
</html>
